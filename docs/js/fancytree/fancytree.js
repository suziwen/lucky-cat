!function(){"use strict";var e="undefined"!=typeof window?window:global;if("function"!=typeof e.requirejs){var t={},n={},r=function(e,t){return{}.hasOwnProperty.call(e,t)},i=function(e,t){for(var n,r,i=[],o=0,s=(n=/^\.\.?(\/|$)/.test(t)?[e,t].join("/").split("/"):t.split("/")).length;o<s;o++)".."===(r=n[o])?i.pop():"."!==r&&""!==r&&i.push(r);return i.join("/")},o=function(t,r){var o,s={id:t,exports:{}};return n[t]=s,r(s.exports,(o=t,function(t){var n=function(e){return e.split("/").slice(0,-1).join("/")}(o),r=i(n,t);return e.requirejs(r,o)}),s),s.exports},s=function(e,n){if("object"==typeof e)for(var i in e)r(e,i)&&(t[i]=e[i]);else t[e]=n};e.requirejs=function(e,s){var a=i(e,".");if(null==s&&(s="/"),r(n,a))return n[a].exports;if(r(t,a))return o(a,t[a]);var l=i(a,"./index");if(r(n,l))return n[l].exports;if(r(t,l))return o(l,t[l]);throw new Error('Cannot find module "'+e+'" from "'+s+'"')},e.requirejs.define=s,e.requirejs.register=s,e.requirejs.list=function(){var e=[];for(var n in t)r(t,n)&&e.push(n);return e},e.requirejs.brunch=!0}}(),function(e,t,n,r){"use strict";if(e.ui&&e.ui.fancytree)e.ui.fancytree.warn("Fancytree: ignored duplicate include");else{p(e.ui,"Fancytree requires jQuery UI (http://jqueryui.com)");var i,o=null,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},a={16:!0,17:!0,18:!0},l={8:"backspace",9:"tab",10:"return",13:"return",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},d="active expanded focus folder hideCheckbox lazy selected unselectable".split(" "),c={},u="expanded extraClasses folder hideCheckbox key lazy refKey selected title tooltip unselectable".split(" "),h={},f={active:!0,children:!0,data:!0,focus:!0};for(i=0;i<d.length;i++)c[d[i]]=!0;for(i=0;i<u.length;i++)h[u[i]]=!0;N.prototype={_findDirectChild:function(e){var t,n,r=this.children;if(r)if("string"==typeof e){for(t=0,n=r.length;t<n;t++)if(r[t].key===e)return r[t]}else{if("number"==typeof e)return this.children[e];if(e.parent===this)return e}return null},_setChildren:function(e){p(e&&(!this.children||0===this.children.length),"only init supported"),this.children=[];for(var t=0,n=e.length;t<n;t++)this.children.push(new N(this,e[t]))},addChildren:function(t,n){var r,i,o,s,a=[];for(e.isPlainObject(t)&&(t=[t]),this.children||(this.children=[]),r=0,i=t.length;r<i;r++)a.push(new N(this,t[r]));return s=a[0],null==n?this.children=this.children.concat(a):(n=this._findDirectChild(n),p((o=e.inArray(n,this.children))>=0,"insertBefore must be an existing child"),this.children.splice.apply(this.children,[o,0].concat(a))),(!this.parent||this.parent.ul||this.tr)&&this.render(),3===this.tree.options.selectMode&&this.fixSelection3FromEndNodes(),s},addNode:function(e,t){switch(void 0!==t&&"over"!==t||(t="child"),t){case"after":return this.getParent().addChildren(e,this.getNextSibling());case"before":return this.getParent().addChildren(e,this);case"firstChild":var n=this.children?this.children[0]:null;return this.addChildren(e,n);case"child":case"over":return this.addChildren(e)}p(!1,"Invalid mode: "+t)},appendSibling:function(e){return this.addNode(e,"after")},applyPatch:function(t){if(null===t)return this.remove(),m(this);var n,r,i={children:!0,expanded:!0,parent:!0};for(n in t)r=t[n],i[n]||e.isFunction(r)||(h[n]?this[n]=r:this.data[n]=r);return t.hasOwnProperty("children")&&(this.removeChildren(),t.children&&this._setChildren(t.children)),this.isVisible()&&(this.renderTitle(),this.renderStatus()),t.hasOwnProperty("expanded")?this.setExpanded(t.expanded):m(this)},collapseSiblings:function(){return this.tree._callHook("nodeCollapseSiblings",this)},copyTo:function(e,t,n){return e.addNode(this.toDict(!0,n),t)},countChildren:function(e){var t,n,r,i=this.children;if(!i)return 0;if(r=i.length,!1!==e)for(t=0,n=r;t<n;t++)r+=i[t].countChildren();return r},debug:function(e){this.tree.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),y("log",arguments))},discard:function(){return this.warn("FancytreeNode.discard() is deprecated since 2014-02-16. Use .resetLazy() instead."),this.resetLazy()},findAll:function(t){t=e.isFunction(t)?t:C(t);var n=[];return this.visit((function(e){t(e)&&n.push(e)})),n},findFirst:function(t){t=e.isFunction(t)?t:C(t);var n=null;return this.visit((function(e){if(t(e))return n=e,!1})),n},_changeSelectStatusAttrs:function(e){var t=!1;switch(e){case!1:t=this.selected||this.partsel,this.selected=!1,this.partsel=!1;break;case!0:t=!this.selected||!this.partsel,this.selected=!0,this.partsel=!0;break;case void 0:t=this.selected||!this.partsel,this.selected=!1,this.partsel=!0;break;default:p(!1,"invalid state: "+e)}return t&&this.renderStatus(),t},fixSelection3AfterClick:function(){var e=this.isSelected();this.visit((function(t){t._changeSelectStatusAttrs(e)})),this.fixSelection3FromEndNodes()},fixSelection3FromEndNodes:function(){p(3===this.tree.options.selectMode,"expected selectMode 3"),function e(t){var n,r,i,o,s,a,l=t.children;if(l&&l.length){for(s=!0,a=!1,n=0,r=l.length;n<r;n++)!1!==(i=e(l[n]))&&(a=!0),!0!==i&&(s=!1);o=!!s||!!a&&void 0}else o=!!t.selected;return t._changeSelectStatusAttrs(o),o}(this),this.visitParents((function(e){var t,n,r,i,o=e.children,s=!0,a=!1;for(t=0,n=o.length;t<n;t++)((r=o[t]).selected||r.partsel)&&(a=!0),r.unselectable||r.selected||(s=!1);i=!!s||!!a&&void 0,e._changeSelectStatusAttrs(i)}))},fromDict:function(t){for(var n in t)h[n]?this[n]=t[n]:"data"===n?e.extend(this.data,t.data):e.isFunction(t[n])||f[n]||(this.data[n]=t[n]);t.children&&(this.removeChildren(),this.addChildren(t.children)),this.renderTitle()},getChildren:function(){if(void 0!==this.hasChildren())return this.children},getFirstChild:function(){return this.children?this.children[0]:null},getIndex:function(){return e.inArray(this,this.parent.children)},getIndexHier:function(t){t=t||".";var n=[];return e.each(this.getParentList(!1,!0),(function(e,t){n.push(t.getIndex()+1)})),n.join(t)},getKeyPath:function(e){var t=[],n=this.tree.options.keyPathSeparator;return this.visitParents((function(e){e.parent&&t.unshift(e.key)}),!e),n+t.join(n)},getLastChild:function(){return this.children?this.children[this.children.length-1]:null},getLevel:function(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e},getNextSibling:function(){if(this.parent){var e,t,n=this.parent.children;for(e=0,t=n.length-1;e<t;e++)if(n[e]===this)return n[e+1]}return null},getParent:function(){return this.parent},getParentList:function(e,t){for(var n=[],r=t?this:this.parent;r;)(e||r.parent)&&n.unshift(r),r=r.parent;return n},getPrevSibling:function(){if(this.parent){var e,t,n=this.parent.children;for(e=1,t=n.length;e<t;e++)if(n[e]===this)return n[e-1]}return null},hasChildren:function(){if(this.lazy){if(null==this.children)return;if(0===this.children.length)return!1;if(1===this.children.length&&this.children[0].isStatusNode())return;return!0}return!(!this.children||!this.children.length)},hasFocus:function(){return this.tree.hasFocus()&&this.tree.focusNode===this},info:function(e){this.tree.options.debugLevel>=1&&(Array.prototype.unshift.call(arguments,this.toString()),y("info",arguments))},isActive:function(){return this.tree.activeNode===this},isChildOf:function(e){return this.parent&&this.parent===e},isDescendantOf:function(e){if(!e||e.tree!==this.tree)return!1;for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1},isExpanded:function(){return!!this.expanded},isFirstSibling:function(){var e=this.parent;return!e||e.children[0]===this},isFolder:function(){return!!this.folder},isLastSibling:function(){var e=this.parent;return!e||e.children[e.children.length-1]===this},isLazy:function(){return!!this.lazy},isLoaded:function(){return!this.lazy||void 0!==this.hasChildren()},isLoading:function(){return!!this._isLoading},isRoot:function(){return this.isRootNode()},isRootNode:function(){return this.tree.rootNode===this},isSelected:function(){return!!this.selected},isStatusNode:function(){return!!this.statusNodeType},isTopLevel:function(){return this.tree.rootNode===this.parent},isUndefined:function(){return void 0===this.hasChildren()},isVisible:function(){var e,t,n=this.getParentList(!1,!1);for(e=0,t=n.length;e<t;e++)if(!n[e].expanded)return!1;return!0},lazyLoad:function(e){return this.warn("FancytreeNode.lazyLoad() is deprecated since 2014-02-16. Use .load() instead."),this.load(e)},load:function(e){var t,n,r=this;return p(this.isLazy(),"load() requires a lazy node"),e||this.isUndefined()?(this.isLoaded()&&this.resetLazy(),!1===(n=this.tree._triggerNodeEvent("lazyLoad",this))?m(this):(p("boolean"!=typeof n,"lazyLoad event must return source in data.result"),t=this.tree._callHook("nodeLoadChildren",this,n),this.expanded&&t.always((function(){r.render()})),t)):m(this)},makeVisible:function(t){var n,r=this,i=[],o=new e.Deferred,s=this.getParentList(!1,!1),a=s.length,l=!(t&&!0===t.noAnimation),d=!(t&&!1===t.scrollIntoView);for(n=a-1;n>=0;n--)i.push(s[n].setExpanded(!0,t));return e.when.apply(e,i).done((function(){d?r.scrollIntoView(l).done((function(){o.resolve()})):o.resolve()})),o.promise()},moveTo:function(t,n,r){void 0!==n&&"over"!==n||(n="child");var i,o=this.parent,s="child"===n?t:t.parent;if(this!==t){if(!this.parent)throw"Cannot move system root";if(s.isDescendantOf(this))throw"Cannot move a node to its own descendant";if(1===this.parent.children.length){if(this.parent===s)return;this.parent.children=this.parent.lazy?[]:null,this.parent.expanded=!1}else p((i=e.inArray(this,this.parent.children))>=0),this.parent.children.splice(i,1);if(this.parent=s,s.hasChildren())switch(n){case"child":s.children.push(this);break;case"before":p((i=e.inArray(t,s.children))>=0),s.children.splice(i,0,this);break;case"after":p((i=e.inArray(t,s.children))>=0),s.children.splice(i+1,0,this);break;default:throw"Invalid mode "+n}else s.children=[this];r&&t.visit(r,!0),this.tree!==t.tree&&(this.warn("Cross-tree moveTo is experimantal!"),this.visit((function(e){e.tree=t.tree}),!0)),o.isDescendantOf(s)||o.render(),s.isDescendantOf(o)||s===o||s.render()}},navigate:function(t,n){var r,i,o=e.ui.keyCode,s=null;function a(r){if(r){try{r.makeVisible()}catch(e){}return e(r.span).is(":visible")?!1===n?r.setFocus():r.setActive():(r.debug("Navigate: skipping hidden node"),void r.navigate(t,n))}}switch(t){case o.BACKSPACE:this.parent&&this.parent.parent&&a(this.parent);break;case o.LEFT:this.expanded?(this.setExpanded(!1),a(this)):this.parent&&this.parent.parent&&a(this.parent);break;case o.RIGHT:this.expanded||!this.children&&!this.lazy?this.children&&this.children.length&&a(this.children[0]):(this.setExpanded(),a(this));break;case o.UP:for(s=this.getPrevSibling();s&&!e(s.span).is(":visible");)s=s.getPrevSibling();for(;s&&s.expanded&&s.children&&s.children.length;)s=s.children[s.children.length-1];!s&&this.parent&&this.parent.parent&&(s=this.parent),a(s);break;case o.DOWN:if(this.expanded&&this.children&&this.children.length)s=this.children[0];else for(r=(i=this.getParentList(!1,!0)).length-1;r>=0;r--){for(s=i[r].getNextSibling();s&&!e(s.span).is(":visible");)s=s.getNextSibling();if(s)break}a(s);break;default:!1}},remove:function(){return this.parent.removeChild(this)},removeChild:function(e){return this.tree._callHook("nodeRemoveChild",this,e)},removeChildren:function(){return this.tree._callHook("nodeRemoveChildren",this)},render:function(e,t){return this.tree._callHook("nodeRender",this,e,t)},renderTitle:function(){return this.tree._callHook("nodeRenderTitle",this)},renderStatus:function(){return this.tree._callHook("nodeRenderStatus",this)},resetLazy:function(){this.removeChildren(),this.expanded=!1,this.lazy=!0,this.children=void 0,this.renderStatus()},scheduleAction:function(e,t){this.tree.timer&&clearTimeout(this.tree.timer),this.tree.timer=null;var n=this;switch(e){case"cancel":break;case"expand":this.tree.timer=setTimeout((function(){n.tree.debug("setTimeout: trigger expand"),n.setExpanded(!0)}),t);break;case"activate":this.tree.timer=setTimeout((function(){n.tree.debug("setTimeout: trigger activate"),n.setActive(!0)}),t);break;default:throw"Invalid mode "+e}},scrollIntoView:function(r,i){var o;void 0!==i&&((o=i).tree&&void 0!==o.statusNodeType)&&(this.warn("scrollIntoView() with 'topNode' option is deprecated since 2014-05-08. Use 'options.topNode' instead."),i={topNode:i});var s,a,l,d=e.extend({effects:!0===r?{duration:200,queue:!1}:r,scrollOfs:this.tree.options.scrollOfs,scrollParent:this.tree.options.scrollParent||this.tree.$container,topNode:null},i),c=new e.Deferred,u=this,h=e(this.span).height(),f=e(d.scrollParent),y=d.scrollOfs.top||0,g=d.scrollOfs.bottom||0,v=f.height(),m=f.scrollTop(),x=f,b=f[0]===t,_=d.topNode||null,k=null;return p(e(this.span).is(":visible"),"scrollIntoView node is invisible"),b?(a=e(this.span).offset().top,s=_&&_.span?e(_.span).offset().top:0,x=e("html,body")):(p(f[0]!==n&&f[0]!==n.body,"scrollParent should be an simple element or `window`, not document or body."),l=f.offset().top,a=e(this.span).offset().top-l+m,s=_?e(_.span).offset().top-l+m:0,v-=Math.max(0,f.innerHeight()-f[0].clientHeight)),a<m+y?k=a-y:a+h>m+v-g&&(k=a+h-v+g,_&&(p(_.isRoot()||e(_.span).is(":visible"),"topNode must be visible"),s<k&&(k=s-y))),null!==k?d.effects?(d.effects.complete=function(){c.resolveWith(u)},x.stop(!0).animate({scrollTop:k},d.effects)):(x[0].scrollTop=k,c.resolveWith(this)):c.resolveWith(this),c.promise()},setActive:function(e,t){return this.tree._callHook("nodeSetActive",this,e,t)},setExpanded:function(e,t){return this.tree._callHook("nodeSetExpanded",this,e,t)},setFocus:function(e){return this.tree._callHook("nodeSetFocus",this,e)},setSelected:function(e){return this.tree._callHook("nodeSetSelected",this,e)},setStatus:function(e,t,n){return this.tree._callHook("nodeSetStatus",this,e,t,n)},setTitle:function(e){this.title=e,this.renderTitle()},sortChildren:function(e,t){var n,r,i=this.children;if(i){if(e=e||function(e,t){var n=e.title.toLowerCase(),r=t.title.toLowerCase();return n===r?0:n>r?1:-1},i.sort(e),t)for(n=0,r=i.length;n<r;n++)i[n].children&&i[n].sortChildren(e,"$norender$");"$norender$"!==t&&this.render()}},toDict:function(t,n){var r,i,o,s={},a=this;if(e.each(u,(function(e,t){(a[t]||!1===a[t])&&(s[t]=a[t])})),e.isEmptyObject(this.data)||(s.data=e.extend({},this.data),e.isEmptyObject(s.data)&&delete s.data),n&&n(s),t&&this.hasChildren())for(s.children=[],r=0,i=this.children.length;r<i;r++)(o=this.children[r]).isStatusNode()||s.children.push(o.toDict(!0,n));return s},toggleExpanded:function(){return this.tree._callHook("nodeToggleExpanded",this)},toggleSelected:function(){return this.tree._callHook("nodeToggleSelected",this)},toString:function(){return"<FancytreeNode(#"+this.key+", '"+this.title+"')>"},visit:function(e,t){var n,r,i=!0,o=this.children;if(!0===t&&(!1===(i=e(this))||"skip"===i))return i;if(o)for(n=0,r=o.length;n<r&&!1!==(i=o[n].visit(e,!0));n++);return i},visitAndLoad:function(t,n,r){var i,o,s,a=this;return!t||!0!==n||!1!==(o=t(a))&&"skip"!==o?a.children||a.lazy?(i=new e.Deferred,s=[],a.load().done((function(){for(var n=0,r=a.children.length;n<r;n++){if(!1===(o=a.children[n].visitAndLoad(t,!0,!0))){i.reject();break}"skip"!==o&&s.push(o)}e.when.apply(this,s).then((function(){i.resolve()}))})),i.promise()):m():r?o:m()},visitParents:function(e,t){if(t&&!1===e(this))return!1;for(var n=this.parent;n;){if(!1===e(n))return!1;n=n.parent}return!0},warn:function(e){Array.prototype.unshift.call(arguments,this.toString()),y("warn",arguments)}},S.prototype={_makeHookContext:function(t,n,r){var i,o;return void 0!==t.node?(n&&t.originalEvent!==n&&e.error("invalid args"),i=t):t.tree?i={node:t,tree:o=t.tree,widget:o.widget,options:o.widget.options,originalEvent:n}:t.widget?i={node:null,tree:t,widget:t.widget,options:t.widget.options,originalEvent:n}:e.error("invalid args"),r&&e.extend(i,r),i},_callHook:function(t,n,r){var i=this._makeHookContext(n),o=this[t],s=Array.prototype.slice.call(arguments,2);return e.isFunction(o)||e.error("_callHook('"+t+"') is not a function"),s.unshift(i),o.apply(this,s)},_requireExtension:function(t,n,r,i){r=!!r;var o=this._local.name,s=this.options.extensions,a=e.inArray(t,s)<e.inArray(o,s),l=n&&null==this.ext[t],d=!l&&null!=r&&r!==a;return p(o&&o!==t),!l&&!d||(i||(l||n?(i="'"+o+"' extension requires '"+t+"'",d&&(i+=" to be registered "+(r?"before":"after")+" itself")):i="If used together, `"+t+"` must be registered "+(r?"before":"after")+" `"+o+"`"),e.error(i),!1)},activateKey:function(e){var t=this.getNodeByKey(e);return t?t.setActive():this.activeNode&&this.activeNode.setActive(!1),t},applyPatch:function(t){var n,r,i,o,s,a,l=t.length,d=[];for(r=0;r<l;r++)p(2===(i=t[r]).length,"patchList must be an array of length-2-arrays"),o=i[0],s=i[1],(a=null===o?this.rootNode:this.getNodeByKey(o))?(n=new e.Deferred,d.push(n),a.applyPatch(s).always(b(n,a))):this.warn("could not find node with key '"+o+"'");return e.when.apply(e,d).promise()},count:function(){return this.rootNode.countChildren()},debug:function(e){this.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),y("log",arguments))},findNextNode:function(t,n,r){var i,o=null,s=n.parent.children,a=null,l=function(e,t,n){var r,i,o=e.children,s=o.length,a=o[t];if(a&&!1===n(a))return!1;if(a&&a.children&&a.expanded&&!1===l(a,0,n))return!1;for(r=t+1;r<s;r++)if(!1===l(e,r,n))return!1;return(i=e.parent)?l(i,i.children.indexOf(e)+1,n):l(e,0,n)};return t="string"==typeof t?(i=new RegExp("^"+t,"i"),function(e){return i.test(e.title)}):t,n=n||this.getFirstChild(),l(n.parent,s.indexOf(n),(function(r){return r!==o&&(o=o||r,e(r.span).is(":visible")?(!t(r)||(a=r)===n)&&void 0:void r.debug("quicksearch: skipping hidden node"))})),a},generateFormElements:function(t,n){var r,i=!1!==t?"ft_"+this._id+"[]":t,o=!1!==n?"ft_"+this._id+"_active":n,s="fancytree_result_"+this._id,a=e("#"+s);a.length?a.empty():a=e("<div>",{id:s}).hide().insertAfter(this.$container),i&&(r=this.getSelectedNodes(3===this.options.selectMode),e.each(r,(function(t,n){a.append(e("<input>",{type:"checkbox",name:i,value:n.key,checked:!0}))}))),o&&this.activeNode&&a.append(e("<input>",{type:"radio",name:o,value:this.activeNode.key,checked:!0}))},getActiveNode:function(){return this.activeNode},getFirstChild:function(){return this.rootNode.getFirstChild()},getFocusNode:function(e){return this.focusNode},getNodeByKey:function(e,t){var r,i;return!t&&(r=n.getElementById(this.options.idPrefix+e))?r.ftnode?r.ftnode:null:(t=t||this.rootNode,i=null,t.visit((function(t){if(t.key===e)return i=t,!1}),!0),i)},getRootNode:function(){return this.rootNode},getSelectedNodes:function(e){var t=[];return this.rootNode.visit((function(n){if(n.selected&&(t.push(n),!0===e))return"skip"})),t},hasFocus:function(){return!!this._hasFocus},info:function(e){this.options.debugLevel>=1&&(Array.prototype.unshift.call(arguments,this.toString()),y("info",arguments))},loadKeyPath:function(t,n,r){var i,o,s,a,l,d,c,u,h,f=this.options.keyPathSeparator,p=this;for(e.isArray(t)||(t=[t]),d={},s=0;s<t.length;s++)for(u=r||this.rootNode,(a=t[s]).charAt(0)===f&&(a=a.substr(1)),h=a.split(f);h.length;){if(l=h.shift(),!(c=u._findDirectChild(l))){this.warn("loadKeyPath: key not found: "+l+" (parent: "+u+")"),n.call(this,l,"error");break}if(0===h.length){n.call(this,c,"ok");break}if(c.lazy&&void 0===c.hasChildren()){n.call(this,c,"loaded"),d[l]?d[l].push(h.join(f)):d[l]=[h.join(f)];break}n.call(this,c,"loaded"),u=c}function y(e,t,r){n.call(p,t,"loading"),t.load().done((function(){p.loadKeyPath.call(p,d[e],n,t).always(b(r,p))})).fail((function(i){p.warn("loadKeyPath: error loading: "+e+" (parent: "+u+")"),n.call(p,t,"error"),r.reject()}))}for(l in i=[],d)c=u._findDirectChild(l),o=new e.Deferred,i.push(o),y(l,c,o);return e.when.apply(e,i).promise()},reactivate:function(e){var t,n=this.activeNode;return n?(this.activeNode=null,t=n.setActive(),e&&n.setFocus(),t):m()},reload:function(e){return this._callHook("treeClear",this),this._callHook("treeLoad",this,e)},render:function(e,t){return this.rootNode.render(e,t)},setFocus:function(e){return this._callHook("treeSetFocus",this,e)},toDict:function(e,t){var n=this.rootNode.toDict(!0,t);return e?n:n.children},toString:function(){return"<Fancytree(#"+this._id+")>"},_triggerNodeEvent:function(e,t,n,r){var i=this._makeHookContext(t,n,r),o=this.widget._trigger(e,n,i);return!1!==o&&void 0!==i.result?i.result:o},_triggerTreeEvent:function(e,t,n){var r=this._makeHookContext(this,t,n),i=this.widget._trigger(e,t,r);return!1!==i&&void 0!==r.result?r.result:i},visit:function(e){return this.rootNode.visit(e,!1)},warn:function(e){Array.prototype.unshift.call(arguments,this.toString()),y("warn",arguments)}},e.extend(S.prototype,{nodeClick:function(e){var t,n,r=e.targetType,i=e.node;if("expander"===r)this._callHook("nodeToggleExpanded",e);else if("checkbox"===r)this._callHook("nodeToggleSelected",e),e.options.focusOnSelect&&this._callHook("nodeSetFocus",e,!0);else{if(n=!1,t=!0,i.folder)switch(e.options.clickFolderMode){case 2:n=!0,t=!1;break;case 3:t=!0,n=!0}t&&(this.nodeSetFocus(e),this._callHook("nodeSetActive",e,!0)),n&&this._callHook("nodeToggleExpanded",e)}},nodeCollapseSiblings:function(e,t){var n,r,i,o=e.node;if(o.parent)for(r=0,i=(n=o.parent.children).length;r<i;r++)n[r]!==o&&n[r].expanded&&this._callHook("nodeSetExpanded",n[r],!1,t)},nodeDblclick:function(e){"title"===e.targetType&&4===e.options.clickFolderMode&&this._callHook("nodeToggleExpanded",e),"title"===e.targetType&&e.originalEvent.preventDefault()},nodeKeydown:function(t){var n,r,i=t.originalEvent,s=t.node,a=t.tree,l=t.options,d=i.which,c=String.fromCharCode(d),u=!(i.altKey||i.ctrlKey||i.metaKey||i.shiftKey),h=e(i.target),f=!0,p=!(i.ctrlKey||!l.autoActivate);if(s||(this.getFirstChild().setFocus(),(s=t.node=this.focusNode).debug("Keydown force focus on first node")),l.quicksearch&&u&&/\w/.test(c)&&!h.is(":input:enabled"))return(r=(new Date).getTime())-a.lastQuicksearchTime>500&&(a.lastQuicksearchTerm=""),a.lastQuicksearchTime=r,a.lastQuicksearchTerm+=c,(n=a.findNextNode(a.lastQuicksearchTerm,a.getActiveNode()))&&n.setActive(),void i.preventDefault();switch(o.keyEventToString(i)){case"+":case"=":a.nodeSetExpanded(t,!0);break;case"-":a.nodeSetExpanded(t,!1);break;case"space":l.checkbox?a.nodeToggleSelected(t):a.nodeSetActive(t,!0);break;case"enter":a.nodeSetActive(t,!0);break;case"backspace":case"left":case"right":case"up":case"down":s.navigate(i.which,p);break;default:f=!1}f&&i.preventDefault()},nodeLoadChildren:function(t,n){var r,i,o,s=t.tree,a=t.node;return e.isFunction(n)&&(n=n()),n.url&&((r=e.extend({},t.options.ajax,n)).debugDelay?(i=r.debugDelay,e.isArray(i)&&(i=i[0]+Math.random()*(i[1]-i[0])),a.debug("nodeLoadChildren waiting debug delay "+Math.round(i)+"ms"),r.debugDelay=!1,o=e.Deferred((function(t){setTimeout((function(){e.ajax(r).done((function(){t.resolveWith(this,arguments)})).fail((function(){t.rejectWith(this,arguments)}))}),i)}))):o=e.ajax(r),n=new e.Deferred,o.done((function(r,i,o){var l,d;if("string"==typeof r&&e.error("Ajax request returned a string (did you get the JSON dataType wrong?)."),t.options.postProcess){if((d=s._triggerNodeEvent("postProcess",t,t.originalEvent,{response:r,error:null,dataType:this.dataType})).error)return l=e.isPlainObject(d.error)?d.error:{message:d.error},l=s._makeHookContext(a,null,l),void n.rejectWith(this,[l]);r=e.isArray(d)?d:r}else r&&r.hasOwnProperty("d")&&t.options.enableAspx&&(r="string"==typeof r.d?e.parseJSON(r.d):r.d);n.resolveWith(this,[r])})).fail((function(e,t,r){var i=s._makeHookContext(a,null,{error:e,args:Array.prototype.slice.call(arguments),message:r,details:e.status+": "+r});n.rejectWith(this,[i])}))),e.isFunction(n.promise)&&(p(!a.isLoading()),s.nodeSetStatus(t,"loading"),n.done((function(e){s.nodeSetStatus(t,"ok")})).fail((function(e){var n;n=e.node&&e.error&&e.message?e:s._makeHookContext(a,null,{error:e,args:Array.prototype.slice.call(arguments),message:e?e.message||e.toString():""}),!1!==s._triggerNodeEvent("loadError",n,null)&&s.nodeSetStatus(t,"error",n.message,n.details)}))),e.when(n).done((function(t){var n;e.isPlainObject(t)&&(p(e.isArray(t.children),"source must contain (or be) an array of children"),p(a.isRoot(),"source may only be an object for root nodes"),n=t,t=t.children,delete n.children,e.extend(s.data,n)),p(e.isArray(t),"expected array of children"),a._setChildren(t),s._triggerNodeEvent("loadChildren",a)}))},nodeLoadKeyPath:function(e,t){},nodeRemoveChild:function(t,n){var r,i=t.node,o=t.options,s=e.extend({},t,{node:n}),a=i.children;if(1===a.length)return p(n===a[0]),this.nodeRemoveChildren(t);this.activeNode&&(n===this.activeNode||this.activeNode.isDescendantOf(n))&&this.activeNode.setActive(!1),this.focusNode&&(n===this.focusNode||this.focusNode.isDescendantOf(n))&&(this.focusNode=null),this.nodeRemoveMarkup(s),this.nodeRemoveChildren(s),p((r=e.inArray(n,a))>=0),n.visit((function(e){e.parent=null}),!0),this._callHook("treeRegisterNode",this,!1,n),o.removeNode&&o.removeNode.call(t.tree,{type:"removeNode"},s),a.splice(r,1)},nodeRemoveChildMarkup:function(t){var n=t.node;n.ul&&(n.isRoot()?e(n.ul).empty():(e(n.ul).remove(),n.ul=null),n.visit((function(e){e.li=e.ul=null})))},nodeRemoveChildren:function(t){var n,r=t.tree,i=t.node,o=i.children,s=t.options;o&&(this.activeNode&&this.activeNode.isDescendantOf(i)&&this.activeNode.setActive(!1),this.focusNode&&this.focusNode.isDescendantOf(i)&&(this.focusNode=null),this.nodeRemoveChildMarkup(t),n=e.extend({},t),i.visit((function(e){e.parent=null,r._callHook("treeRegisterNode",r,!1,e),s.removeNode&&(n.node=e,s.removeNode.call(t.tree,{type:"removeNode"},n))})),i.lazy?i.children=[]:i.children=null,this.nodeRenderStatus(t))},nodeRemoveMarkup:function(t){var n=t.node;n.li&&(e(n.li).remove(),n.li=null),this.nodeRemoveChildMarkup(t)},nodeRender:function(t,r,i,o,s){var a,l,d,c,u,h,f,y=t.node,g=t.tree,v=t.options,m=v.aria,x=!1,b=y.parent,_=!b,k=y.children;if(_||b.ul){if(p(_||b.ul,"parent UL must exist"),_||(y.li&&(r||y.li.parentNode!==y.parent.ul)&&(y.li.parentNode!==y.parent.ul&&this.debug("Unlinking "+y+" (must be child of "+y.parent+")"),this.nodeRemoveMarkup(t)),y.li?this.nodeRenderStatus(t):(x=!0,y.li=n.createElement("li"),y.li.ftnode=y,y.key&&v.generateIds&&(y.li.id=v.idPrefix+y.key),y.span=n.createElement("span"),y.span.className="fancytree-node",m&&e(y.span).attr("aria-labelledby","ftal_"+y.key),y.li.appendChild(y.span),this.nodeRenderTitle(t),v.createNode&&v.createNode.call(g,{type:"createNode"},t)),v.renderNode&&v.renderNode.call(g,{type:"renderNode"},t)),k){if(_||y.expanded||!0===i){for(y.ul||(y.ul=n.createElement("ul"),(!0!==o||s)&&y.expanded||(y.ul.style.display="none"),m&&e(y.ul).attr("role","group"),y.li?y.li.appendChild(y.ul):y.tree.$div.append(y.ul)),c=0,u=k.length;c<u;c++)f=e.extend({},t,{node:k[c]}),this.nodeRender(f,r,i,!1,!0);for(a=y.ul.firstChild;a;)(d=a.ftnode)&&d.parent!==y?(y.debug("_fixParent: remove missing "+d,a),h=a.nextSibling,a.parentNode.removeChild(a),a=h):a=a.nextSibling;for(a=y.ul.firstChild,c=0,u=k.length-1;c<u;c++)(l=k[c])!==(d=a.ftnode)?y.ul.insertBefore(l.li,d.li):a=a.nextSibling}}else y.ul&&(this.warn("remove child markup for "+y),this.nodeRemoveChildMarkup(t));_||x&&b.ul.appendChild(y.li)}},nodeRenderTitle:function(e,t){var n,r,i,s,a=e.node,l=e.tree,d=e.options,c=d.aria,u=a.getLevel(),h=[],f=a.data.icon;void 0!==t&&(a.title=t),a.span&&(u<d.minExpandLevel?(a.lazy||(a.expanded=!0),u>1&&(c?h.push("<span role='button' class='fancytree-expander fancytree-expander-fixed'></span>"):h.push("<span class='fancytree-expander fancytree-expander-fixed''></span>"))):c?h.push("<span role='button' class='fancytree-expander'></span>"):h.push("<span class='fancytree-expander'></span>"),d.checkbox&&!0!==a.hideCheckbox&&!a.isStatusNode()&&(c?h.push("<span role='checkbox' class='fancytree-checkbox'></span>"):h.push("<span class='fancytree-checkbox'></span>")),i=c?" role='img'":"",(!0===f||!1!==f&&!1!==d.icons)&&(f&&"string"==typeof f?(f="/"===f.charAt(0)?f:(d.imagePath||"")+f,h.push("<img src='"+f+"' class='fancytree-icon' alt='' />")):(n=d.iconClass&&d.iconClass.call(l,a,e)||a.data.iconclass||null)?h.push("<span "+i+" class='fancytree-custom-icon "+n+"'></span>"):h.push("<span "+i+" class='fancytree-icon'></span>")),r="",d.renderTitle&&(r=d.renderTitle.call(l,{type:"renderTitle"},e)||""),r||(s=a.tooltip?" title='"+o.escapeHtml(a.tooltip)+"'":"",r="<span "+(i=c?" role='treeitem'":"")+" class='fancytree-title'"+(c?" id='ftal_"+a.key+"'":"")+s+(d.titlesTabbable?" tabindex='0'":"")+">"+_.escape(a.title)+"</span>"),h.push(r),a.span.innerHTML=h.join(""),this.nodeRenderStatus(e))},nodeRenderStatus:function(t){var n=t.node,r=t.tree,i=t.options,o=n.hasChildren(),s=n.isLastSibling(),a=i.aria,l=e(n.span).find(".fancytree-title"),d=i._classNames,c=[],u=n[r.statusClassPropName];u&&(c.push(d.node),r.activeNode===n&&c.push(d.active),r.focusNode===n?(c.push(d.focused),a&&l.attr("aria-activedescendant",!0)):a&&l.removeAttr("aria-activedescendant"),n.expanded?(c.push(d.expanded),a&&l.attr("aria-expanded",!0)):a&&l.removeAttr("aria-expanded"),n.folder&&c.push(d.folder),!1!==o&&c.push(d.hasChildren),s&&c.push(d.lastsib),n.lazy&&null==n.children&&c.push(d.lazy),n.partsel&&c.push(d.partsel),n.unselectable&&c.push(d.unselectable),n._isLoading&&c.push(d.loading),n._error&&c.push(d.error),n.selected?(c.push(d.selected),a&&l.attr("aria-selected",!0)):a&&l.attr("aria-selected",!1),n.extraClasses&&c.push(n.extraClasses),!1===o?c.push(d.combinedExpanderPrefix+"n"+(s?"l":"")):c.push(d.combinedExpanderPrefix+(n.expanded?"e":"c")+(n.lazy&&null==n.children?"d":"")+(s?"l":"")),c.push(d.combinedIconPrefix+(n.expanded?"e":"c")+(n.folder?"f":"")),u.className=c.join(" "),n.li&&(n.li.className=s?d.lastsib:""))},nodeSetActive:function(t,n,r){r=r||{};var i,o=t.node,s=t.tree,a=t.options,l=!0===r.noEvents;return o===s.activeNode===(n=!1!==n)?m(o):n&&!l&&!1===this._triggerNodeEvent("beforeActivate",o,t.originalEvent)?x(o,["rejected"]):void(n?(s.activeNode&&(p(s.activeNode!==o,"node was active (inconsistency)"),i=e.extend({},t,{node:s.activeNode}),s.nodeSetActive(i,!1),p(null===s.activeNode,"deactivate was out of sync?")),a.activeVisible&&o.makeVisible({scrollIntoView:!1}),s.activeNode=o,s.nodeRenderStatus(t),s.nodeSetFocus(t),l||s._triggerNodeEvent("activate",o,t.originalEvent)):(p(s.activeNode===o,"node was not active (inconsistency)"),s.activeNode=null,this.nodeRenderStatus(t),l||t.tree._triggerNodeEvent("deactivate",o,t.originalEvent)))},nodeSetExpanded:function(t,n,r){r=r||{};var i,o,s,a,l,d,c=t.node,u=t.tree,h=t.options,f=!0===r.noAnimation,p=!0===r.noEvents;if(n=!1!==n,c.expanded&&n||!c.expanded&&!n)return m(c);if(n&&!c.lazy&&!c.hasChildren())return m(c);if(!n&&c.getLevel()<h.minExpandLevel)return x(c,["locked"]);if(!p&&!1===this._triggerNodeEvent("beforeExpand",c,t.originalEvent))return x(c,["rejected"]);if(f||c.isVisible()||(f=r.noAnimation=!0),o=new e.Deferred,n&&!c.expanded&&h.autoCollapse){l=c.getParentList(!1,!0),d=h.autoCollapse;try{for(h.autoCollapse=!1,s=0,a=l.length;s<a;s++)this._callHook("nodeCollapseSiblings",l[s],r)}finally{h.autoCollapse=d}}return o.done((function(){n&&h.autoScroll&&!f?c.getLastChild().scrollIntoView(!0,{topNode:c}).always((function(){p||t.tree._triggerNodeEvent(n?"expand":"collapse",t)})):p||t.tree._triggerNodeEvent(n?"expand":"collapse",t)})),i=function(r){var i=h.toggleEffect;if(c.expanded=n,u._callHook("nodeRender",t,!1,!1,!0),c.ul)if("none"!==c.ul.style.display===!!c.expanded)c.warn("nodeSetExpanded: UL.style.display already set");else{if(i&&!f)return void e(c.ul).toggle(i.effect,i.options,i.duration,(function(){r()}));c.ul.style.display=c.expanded||!parent?"":"none"}r()},n&&c.lazy&&void 0===c.hasChildren()?c.load().done((function(){o.notifyWith&&o.notifyWith(c,["loaded"]),i((function(){o.resolveWith(c)}))})).fail((function(e){i((function(){o.rejectWith(c,["load failed ("+e+")"])}))})):i((function(){o.resolveWith(c)})),o.promise()},nodeSetFocus:function(t,n){var r,i=t.tree,o=t.node;if(n=!1!==n,i.focusNode){if(i.focusNode===o&&n)return;r=e.extend({},t,{node:i.focusNode}),i.focusNode=null,this._triggerNodeEvent("blur",r),this._callHook("nodeRenderStatus",r)}n&&(this.hasFocus()||(o.debug("nodeSetFocus: forcing container focus"),this._callHook("treeSetFocus",t,!0,!0)),o.makeVisible({scrollIntoView:!1}),i.focusNode=o,this._triggerNodeEvent("focus",t),t.options.autoScroll&&o.scrollIntoView(),this._callHook("nodeRenderStatus",t))},nodeSetSelected:function(e,t){var n=e.node,r=e.tree,i=e.options;if(t=!1!==t,n.debug("nodeSetSelected("+t+")",e),!n.unselectable){if(n.selected&&t||!n.selected&&!t)return!!n.selected;if(!1===this._triggerNodeEvent("beforeSelect",n,e.originalEvent))return!!n.selected;t&&1===i.selectMode?r.lastSelectedNode&&r.lastSelectedNode.setSelected(!1):3===i.selectMode&&(n.selected=t,n.fixSelection3AfterClick()),n.selected=t,this.nodeRenderStatus(e),r.lastSelectedNode=t?n:null,r._triggerNodeEvent("select",e)}},nodeSetStatus:function(t,n,r,i){var o=t.node,s=t.tree;function a(t,n){var r=o.children?o.children[0]:null;return r&&r.isStatusNode()?(e.extend(r,t),s._callHook("nodeRenderTitle",r)):(t.key="_statusNode",o._setChildren([t]),o.children[0].statusNodeType=n,s.render()),o.children[0]}switch(n){case"ok":!function(){var e=o.children?o.children[0]:null;if(e&&e.isStatusNode()){try{o.ul&&(o.ul.removeChild(e.li),e.li=null)}catch(e){}1===o.children.length?o.children=[]:o.children.shift()}}(),o._isLoading=!1,o._error=null,o.renderStatus();break;case"loading":o.parent||a({title:s.options.strings.loading+(r?" ("+r+") ":""),tooltip:i,extraClasses:"fancytree-statusnode-wait"},n),o._isLoading=!0,o._error=null,o.renderStatus();break;case"error":a({title:s.options.strings.loadError+(r?" ("+r+") ":""),tooltip:i,extraClasses:"fancytree-statusnode-error"},n),o._isLoading=!1,o._error={message:r,details:i},o.renderStatus();break;default:e.error("invalid node status "+n)}},nodeToggleExpanded:function(e){return this.nodeSetExpanded(e,!e.node.expanded)},nodeToggleSelected:function(e){return this.nodeSetSelected(e,!e.node.selected)},treeClear:function(e){var t=e.tree;t.activeNode=null,t.focusNode=null,t.$div.find(">ul.fancytree-container").empty(),t.rootNode.children=null},treeCreate:function(e){},treeDestroy:function(e){},treeInit:function(e){this.treeLoad(e)},treeLoad:function(t,n){var r,i,o=t.tree,s=t.widget.element,a=e.extend({},t,{node:this.rootNode});if(o.rootNode.children&&this.treeClear(t),n=n||this.options.source)"string"==typeof n&&e.error("Not implemented");else switch(r=s.data("type")||"html"){case"html":(i=s.find(">ul:first")).addClass("ui-fancytree-source ui-helper-hidden"),n=e.ui.fancytree.parseHtml(i),this.data=e.extend(this.data,k(i));break;case"json":(n=e.parseJSON(s.text())).children&&(n.title&&(o.title=n.title),n=n.children);break;default:e.error("Invalid data-type: "+r)}return this.nodeLoadChildren(a,n).done((function(){o.render(),3===t.options.selectMode&&o.rootNode.fixSelection3FromEndNodes(),o._triggerTreeEvent("init",null,{status:!0})})).fail((function(){o.render(),o._triggerTreeEvent("init",null,{status:!1})}))},treeRegisterNode:function(e,t,n){},treeSetFocus:function(e,t,n){(t=!1!==t)!==this.hasFocus()&&(this._hasFocus=t,this.$container.toggleClass("fancytree-treefocus",t),this._triggerTreeEvent(t?"focusTree":"blurTree"))}}),e.widget("ui.fancytree",{options:{activeVisible:!0,ajax:{type:"GET",cache:!1,dataType:"json"},aria:!1,autoActivate:!0,autoCollapse:!1,autoScroll:!1,checkbox:!1,clickFolderMode:4,debugLevel:null,disabled:!1,enableAspx:!0,extensions:[],toggleEffect:!1,generateIds:!1,icons:!0,idPrefix:"ft_",focusOnSelect:!1,keyboard:!0,keyPathSeparator:"/",minExpandLevel:1,quicksearch:!1,scrollOfs:{top:0,bottom:0},scrollParent:null,selectMode:2,strings:{loading:"Loading&#8230;",loadError:"Load error!"},tabbable:!0,titlesTabbable:!1,_classNames:{node:"fancytree-node",folder:"fancytree-folder",combinedExpanderPrefix:"fancytree-exp-",combinedIconPrefix:"fancytree-ico-",hasChildren:"fancytree-has-children",active:"fancytree-active",selected:"fancytree-selected",expanded:"fancytree-expanded",lazy:"fancytree-lazy",focused:"fancytree-focused",partsel:"fancytree-partsel",unselectable:"fancytree-unselectable",lastsib:"fancytree-lastsib",loading:"fancytree-loading",error:"fancytree-error"},lazyLoad:null,postProcess:null},_create:function(){this.tree=new S(this),this.$source=this.source||"json"===this.element.data("type")?this.element:this.element.find(">ul:first");var t,n,r,i=this.options.extensions;this.tree;for(r=0;r<i.length;r++)n=i[r],(t=e.ui.fancytree._extensions[n])||e.error("Could not apply extension '"+n+"' (it is not registered, did you forget to include it?)"),this.tree.options[n]=e.extend(!0,{},t.options,this.tree.options[n]),p(void 0===this.tree.ext[n],"Extension name must not exist as Fancytree.ext attribute: '"+n+"'"),this.tree.ext[n]={},v(this.tree,0,t,n),t;this.tree._callHook("treeCreate",this.tree)},_init:function(){this.tree._callHook("treeInit",this.tree),this._bind()},_setOption:function(t,n){var r=!0,i=!1;switch(t){case"aria":case"checkbox":case"icons":case"minExpandLevel":case"tabbable":this.tree._callHook("treeCreate",this.tree),i=!0;break;case"source":r=!1,this.tree._callHook("treeLoad",this.tree,n)}this.tree.debug("set option "+t+"="+n+" <"+typeof n+">"),r&&e.Widget.prototype._setOption.apply(this,arguments),i&&this.tree.render(!0,!1)},destroy:function(){this._unbind(),this.tree._callHook("treeDestroy",this.tree),this.tree.$div.find(">ul.fancytree-container").remove(),this.$source&&this.$source.removeClass("ui-helper-hidden"),e.Widget.prototype.destroy.call(this)},_unbind:function(){var t=this.tree._ns;this.element.unbind(t),this.tree.$container.unbind(t),e(n).unbind(t)},_bind:function(){var e=this,t=this.options,n=this.tree,r=n._ns;this._unbind(),n.$container.on("focusin"+r+" focusout"+r,(function(e){var t=o.getNode(e),r="focusin"===e.type;t?n._callHook("nodeSetFocus",t,r):n._callHook("treeSetFocus",n,r)})).on("selectstart"+r,"span.fancytree-title",(function(e){e.preventDefault()})).on("keydown"+r,(function(e){if(t.disabled||!1===t.keyboard)return!0;var r,i=n.focusNode,o=n._makeHookContext(i||n,e),s=n.phase;try{return n.phase="userEvent","preventNav"===(r=i?n._triggerNodeEvent("keydown",i,e):n._triggerTreeEvent("keydown",e))?r=!0:!1!==r&&(r=n._callHook("nodeKeydown",o)),r}finally{n.phase=s}})).on("click"+r+" dblclick"+r,(function(n){if(t.disabled)return!0;var r,i=o.getEventTarget(n),s=i.node,a=e.tree,l=a.phase;if(!s)return!0;r=a._makeHookContext(s,n);try{switch(a.phase="userEvent",n.type){case"click":return r.targetType=i.type,!1!==a._triggerNodeEvent("click",r,n)&&a._callHook("nodeClick",r);case"dblclick":return r.targetType=i.type,!1!==a._triggerNodeEvent("dblclick",r,n)&&a._callHook("nodeDblclick",r)}}finally{a.phase=l}}))},getActiveNode:function(){return this.tree.activeNode},getNodeByKey:function(e){return this.tree.getNodeByKey(e)},getRootNode:function(){return this.tree.rootNode},getTree:function(){return this.tree}}),o=e.ui.fancytree,e.extend(e.ui.fancytree,{version:"2.7.0",buildType:"production",debugLevel:1,_nextId:1,_nextNodeKey:1,_extensions:{},_FancytreeClass:S,_FancytreeNodeClass:N,jquerySupports:{positionMyOfs:function(t,n,r,i){var o,s,a,l=e.map(e.trim(t).split("."),(function(e){return parseInt(e,10)})),d=e.map(Array.prototype.slice.call(arguments,1),(function(e){return parseInt(e,10)}));for(o=0;o<d.length;o++)if((s=l[o]||0)!==(a=d[o]||0))return s>a;return!0}(e.ui.version,1,9)},assert:function(e,t){return p(e,t)},debounce:function(e,t,n,r){var i;return 3===arguments.length&&"boolean"!=typeof n&&(r=n,n=!1),function(){var o=arguments;r=r||this,n&&!i&&t.apply(r,o),clearTimeout(i),i=setTimeout((function(){n||t.apply(r,o),i=null}),e)}},debug:function(t){e.ui.fancytree.debugLevel>=2&&y("log",arguments)},error:function(e){y("error",arguments)},escapeHtml:function(e){return(""+e).replace(/[&<>"'\/]/g,(function(e){return s[e]}))},getEventTargetType:function(e){return this.getEventTarget(e).type},getEventTarget:function(t){var n=t&&t.target?t.target.className:"",r={node:this.getNode(t.target),type:void 0};return/\bfancytree-title\b/.test(n)?r.type="title":/\bfancytree-expander\b/.test(n)?r.type=!1===r.node.hasChildren()?"prefix":"expander":/\bfancytree-checkbox\b/.test(n)||/\bfancytree-radio\b/.test(n)?r.type="checkbox":/\bfancytree-icon\b/.test(n)?r.type="icon":(/\bfancytree-node\b/.test(n)||t&&t.target&&e(t.target).closest(".fancytree-title").length)&&(r.type="title"),r},getNode:function(e){if(e instanceof N)return e;for(void 0!==e.selector?e=e[0]:void 0!==e.originalEvent&&(e=e.target);e;){if(e.ftnode)return e.ftnode;e=e.parentNode}return null},info:function(t){e.ui.fancytree.debugLevel>=1&&y("info",arguments)},keyEventToString:function(e){var t=e.which,n=[];return e.altKey&&n.push("alt"),e.ctrlKey&&n.push("ctrl"),e.metaKey&&n.push("meta"),e.shiftKey&&n.push("shift"),a[t]||n.push(l[t]||String.fromCharCode(t).toLowerCase()),n.join("+")},parseHtml:function(t){var n,r,i,o,s,a,l,h,f=t.find(">li"),p=[];return f.each((function(){var f,y=e(this),g=y.find(">span:first",this),v=g.length?null:y.find(">a:first"),m={tooltip:null,data:{}};for(g.length?m.title=g.text():v&&v.length?(m.title=v.text(),m.data.href=v.attr("href"),m.data.target=v.attr("target"),m.tooltip=v.attr("title")):(m.title=y.text(),(o=m.title.search(/<ul/i))>=0&&(m.title=m.title.substring(0,o))),m.title=e.trim(m.title),r=0,i=d.length;r<i;r++)m[d[r]]=void 0;for(l=this.className.split(" "),n=[],r=0,i=l.length;r<i;r++)h=l[r],c[h]?m[h]=!0:n.push(h);if(m.extraClasses=n.join(" "),(s=y.attr("title"))&&(m.tooltip=s),(s=y.attr("id"))&&(m.key=s),(f=k(y))&&!e.isEmptyObject(f)){for(r=0,i=u.length;r<i;r++)s=u[r],null!=(a=f[s])&&(delete f[s],m[s]=a);e.extend(m.data,f)}(t=y.find(">ul:first")).length?m.children=e.ui.fancytree.parseHtml(t):m.children=m.lazy?void 0:null,p.push(m)})),p},registerExtension:function(t){p(null!=t.name,"extensions must have a `name` property."),p(null!=t.version,"extensions must have a `version` property."),e.ui.fancytree._extensions[t.name]=t},unescapeHtml:function(e){var t=n.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue},warn:function(e){y("warn",arguments)}})}function p(t,n){t||(n=n?": "+n:"",e.error("Fancytree assertion failed"+n))}function y(e,n){var r,i,o=t.console?t.console[e]:null;if(o)try{o.apply(t.console,n)}catch(e){for(i="",r=0;r<n.length;r++)i+=n[r];o(i)}}function g(e,t,n,r,i){var o,s,a,l;return o=t[e],s=r[e],a=t.ext[i],l=function(){return o.apply(t,arguments)},function(){var e=t._local,n=t._super;try{return t._local=a,t._super=l,s.apply(t,arguments)}finally{t._local=e,t._super=n}}}function v(t,n,r,i){for(var o in r)"function"==typeof r[o]?"function"==typeof t[o]?t[o]=g(o,t,0,r,i):"_"===o.charAt(0)?t.ext[i][o]=g(o,t,0,r,i):e.error("Could not override tree."+o+". Use prefix '_' to create tree."+i+"._"+o):"options"!==o&&(t.ext[i][o]=r[o])}function m(t,n){return void 0===t?e.Deferred((function(){this.resolve()})).promise():e.Deferred((function(){this.resolveWith(t,n)})).promise()}function x(t,n){return void 0===t?e.Deferred((function(){this.reject()})).promise():e.Deferred((function(){this.rejectWith(t,n)})).promise()}function b(e,t){return function(){e.resolveWith(t)}}function k(t){var n=e.extend({},t.data()),r=n.json;return delete n.fancytree,r&&(delete n.json,n=e.extend(n,r)),n}function C(e){return e=e.toLowerCase(),function(t){return t.title.toLowerCase().indexOf(e)>=0}}function N(t,n){var r,i,s,a;for(this.parent=t,this.tree=t.tree,this.ul=null,this.li=null,this.statusNodeType=null,this._isLoading=!1,this._error=null,this.data={},r=0,i=u.length;r<i;r++)this[s=u[r]]=n[s];for(s in n.data&&e.extend(this.data,n.data),n)h[s]||e.isFunction(n[s])||f[s]||(this.data[s]=n[s]);null==this.key?this.tree.options.defaultKey?(this.key=this.tree.options.defaultKey(this),p(this.key,"defaultKey() must return a unique key")):this.key="_"+o._nextNodeKey++:this.key=""+this.key,n.active&&(p(null===this.tree.activeNode,"only one active node allowed"),this.tree.activeNode=this),n.selected&&(this.tree.lastSelectedNode=this),this.children=null,(a=n.children)&&a.length&&this._setChildren(a),this.tree._callHook("treeRegisterNode",this.tree,!0,this)}function S(t){this.widget=t,this.$div=t.element,this.options=t.options,this.options&&(e.isFunction(this.options.lazyload)&&!e.isFunction(this.options.lazyLoad)&&(this.options.lazyLoad=function(){return o.warn("The 'lazyload' event is deprecated since 2014-02-25. Use 'lazyLoad' (with uppercase L) instead."),t.options.lazyload.apply(this,arguments)}),e.isFunction(this.options.loaderror)&&e.error("The 'loaderror' event was renamed since 2014-07-03. Use 'loadError' (with uppercase E) instead."),void 0!==this.options.fx&&o.warn("The 'fx' options was replaced by 'toggleEffect' since 2014-11-30.")),this.ext={},this.data=k(this.$div),this._id=e.ui.fancytree._nextId++,this._ns=".fancytree-"+this._id,this.activeNode=null,this.focusNode=null,this._hasFocus=null,this.lastSelectedNode=null,this.systemFocusElement=null,this.lastQuicksearchTerm="",this.lastQuicksearchTime=0,this.statusClassPropName="span",this.ariaPropName="li",this.nodeContainerAttrName="li",this.$div.find(">ul.fancytree-container").remove();var n,r={tree:this};this.rootNode=new N(r,{title:"root",key:"root_"+this._id,children:null,expanded:!0}),this.rootNode.parent=null,n=e("<ul>",{class:"ui-fancytree fancytree-container"}).appendTo(this.$div),this.$container=n,this.rootNode.ul=n[0],null==this.options.debugLevel&&(this.options.debugLevel=o.debugLevel),this.$container.attr("tabindex",this.options.tabbable?"0":"-1"),this.options.aria&&this.$container.attr("role","tree").attr("aria-multiselectable",!0)}}(jQuery,window,document),function(e,t){"use strict";e.ui.fancytree._FancytreeClass.prototype.countSelected=function(e){this.options;return this.getSelectedNodes(e).length},e.ui.fancytree._FancytreeNodeClass.prototype.toUpper=function(){return this.setTitle(this.title.toUpperCase())},e.ui.fancytree.prototype.widgetMethod1=function(e){this.tree;return e},e.ui.fancytree.registerExtension({name:"childcounter",version:"1.0.0",options:{deep:!0,hideZeros:!0,hideExpanded:!1},foo:42,_appendCounter:function(e){},treeInit:function(e){e.options,e.options.childcounter;this._super(e),this.$container.addClass("fancytree-ext-childcounter")},treeDestroy:function(e){this._super(e)},nodeRenderTitle:function(t,n){var r=t.node,i=t.options.childcounter,o=null==r.data.childCounter?r.countChildren(i.deep):+r.data.childCounter;this._super(t,n),!o&&i.hideZeros||r.isExpanded()&&i.hideExpanded||e("span.fancytree-icon",r.span).append(e("<span class='fancytree-childcounter'/>").text(o))},nodeSetExpanded:function(e,t,n){var r=e.tree;e.node;return this._super(e,t,n).always((function(){r.nodeRenderTitle(e)}))}})}(jQuery),function(e,t,n,r){"use strict";function i(t,n){t||(n=n?": "+n:"",e.error("Assertion failed"+n))}e.ui.fancytree._FancytreeNodeClass.prototype.getCloneList=function(t){var n,r=this.tree,i=r.refMap[this.refKey]||null,o=r.keyMap;return i&&(n=this.key,t?i=e.map(i,(function(e){return o[e]})):(i=e.map(i,(function(e){return e===n?null:o[e]}))).length<1&&(i=null)),i},e.ui.fancytree._FancytreeNodeClass.prototype.isClone=function(){var e=this.refKey||null,t=e&&this.tree.refMap[e]||null;return!!(t&&t.length>1)},e.ui.fancytree._FancytreeNodeClass.prototype.reRegister=function(t,n){t=null==t?null:""+t,n=null==n?null:""+n;var r=this.tree,i=this.key,o=this.refKey,s=r.keyMap,a=r.refMap,l=a[o]||null,d=!1;return null!=t&&t!==this.key&&(s[t]&&e.error("[ext-clones] reRegister("+t+"): already exists: "+this),delete s[i],s[t]=this,l&&(a[o]=e.map(l,(function(e){return e===i?t:e}))),this.key=t,d=!0),null!=n&&n!==this.refKey&&(l&&(1===l.length?delete a[o]:a[o]=e.map(l,(function(e){return e===i?null:e}))),a[n]?a[n].append(t):a[n]=[this.key],this.refKey=n,d=!0),d},e.ui.fancytree._FancytreeClass.prototype.getNodesByRef=function(t,n){var r=this.keyMap,i=this.refMap[t]||null;return i&&(i=n?e.map(i,(function(e){var t=r[e];return t.isDescendantOf(n)?t:null})):e.map(i,(function(e){return r[e]}))).length<1&&(i=null),i},e.ui.fancytree._FancytreeClass.prototype.changeRefKey=function(e,t){var n,r=this.keyMap,i=this.refMap[e]||null;if(i){for(n=0;n<i.length;n++)r[i[n]].refKey=t;delete this.refMap[e],this.refMap[t]=i}},e.ui.fancytree.registerExtension({name:"clones",version:"0.0.3",options:{highlightActiveClones:!0,highlightClones:!1},treeCreate:function(e){this._super(e),e.tree.refMap={},e.tree.keyMap={}},treeInit:function(t){this.$container.addClass("fancytree-ext-clones"),i(null==t.options.defaultKey),t.options.defaultKey=function(t){return function(t){var n=e.map(t.getParentList(!1,!0),(function(e){return e.refKey||e.key}));return"id_"+function(e,t,n){for(var r,i,o=3&e.length,s=e.length-o,a=n,l=3432918353,d=461845907,c=0;c<s;)i=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,a=27492+(65535&(r=5*(65535&(a=(a^=i=(65535&(i=(i=(65535&i)*l+(((i>>>16)*l&65535)<<16)&4294967295)<<15|i>>>17))*d+(((i>>>16)*d&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(r>>>16)&65535)<<16);switch(i=0,o){case 3:i^=(255&e.charCodeAt(c+2))<<16;case 2:i^=(255&e.charCodeAt(c+1))<<8;case 1:a^=i=(65535&(i=(i=(65535&(i^=255&e.charCodeAt(c)))*l+(((i>>>16)*l&65535)<<16)&4294967295)<<15|i>>>17))*d+(((i>>>16)*d&65535)<<16)&4294967295}return a^=e.length,a=2246822507*(65535&(a^=a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,a^=a>>>16,t?("0000000"+(a>>>0).toString(16)).substr(-8):a>>>0}(n=n.join("/"),!0)}(t)},this._super(t)},treeClear:function(e){return e.tree.refMap={},e.tree.keyMap={},this._super(e)},treeRegisterNode:function(t,n,r){var o,s,a=t.tree,l=a.keyMap,d=a.refMap,c=r.key,u=r&&null!=r.refKey?""+r.refKey:null;return"_statusNode"===c||(n?(null!=l[r.key]&&e.error("clones.treeRegisterNode: node.key already exists: "+r),l[c]=r,u&&((o=d[u])?(o.push(c),2===o.length&&t.options.clones.highlightClones&&l[o[0]].renderStatus()):d[u]=[c])):(null==l[c]&&e.error("clones.treeRegisterNode: node.key not registered: "+r.key),delete l[c],u&&(o=d[u])&&((s=o.length)<=1?(i(1===s),i(o[0]===c),delete d[u]):(!function(e,t){var n;for(n=e.length-1;n>=0;n--)if(e[n]===t)return e.splice(n,1),!0}(o,c),2===s&&t.options.clones.highlightClones&&l[o[0]].renderStatus())))),this._super(t,n,r)},nodeRenderStatus:function(t){var n,r,i=t.node;return r=this._super(t),t.options.clones.highlightClones&&(n=e(i[t.tree.statusClassPropName])).length&&i.isClone()&&n.addClass("fancytree-clone"),r},nodeSetActive:function(t,n){var r,i=t.tree.statusClassPropName,o=t.node;return r=this._super(t,n),t.options.clones.highlightActiveClones&&o.isClone()&&e.each(o.getCloneList(!0),(function(t,r){e(r[i]).toggleClass("fancytree-active-clone",!1!==n)})),r}})}(jQuery,window,document),function(e,t,n,r){"use strict";var i=!1;function o(t){var n=t.options.dnd||null;n&&function(){if(i)return;e.ui.plugin.add("draggable","connectToFancytree",{start:function(t,n){var r=e(this).data("ui-draggable")||e(this).data("draggable"),i=n.helper.data("ftSourceNode")||null;if(i)return r.offset.click.top=-2,r.offset.click.left=16,i.tree.ext.dnd._onDragEvent("start",i,null,t,n,r)},drag:function(t,n){var r=e(this).data("ui-draggable")||e(this).data("draggable"),i=n.helper.data("ftSourceNode")||null,o=n.helper.data("ftTargetNode")||null,s=e.ui.fancytree.getNode(t.target);t.target&&!s&&e(t.target).closest("div.fancytree-drag-helper,#fancytree-drop-marker").length>0?(i||o||e.ui.fancytree).debug("Drag event over helper: ignored."):(n.helper.data("ftTargetNode",s),o&&o!==s&&o.tree.ext.dnd._onDragEvent("leave",o,i,t,n,r),s&&s.tree.options.dnd.dragDrop&&(s===o?s.tree.ext.dnd._onDragEvent("over",s,i,t,n,r):s.tree.ext.dnd._onDragEvent("enter",s,i,t,n,r)))},stop:function(t,n){var r=e(this).data("ui-draggable")||e(this).data("draggable"),i=n.helper.data("ftSourceNode")||null,o=n.helper.data("ftTargetNode")||null,s="mouseup"===t.type&&1===t.which;s||(i||o||e.ui.fancytree).debug("Drag was cancelled"),o&&(s&&o.tree.ext.dnd._onDragEvent("drop",o,i,t,n,r),o.tree.ext.dnd._onDragEvent("leave",o,i,t,n,r)),i&&i.tree.ext.dnd._onDragEvent("stop",i,null,t,n,r)}}),i=!0}(),n&&n.dragStart&&t.widget.element.draggable(e.extend({addClasses:!1,appendTo:t.$div,containment:!1,delay:0,distance:4,revert:!1,scroll:!0,scrollSpeed:7,scrollSensitivity:10,connectToFancytree:!0,helper:function(t){var n,r=e.ui.fancytree.getNode(t.target),i=e(r.span);return r?((n=e("<div class='fancytree-drag-helper'><span class='fancytree-drag-helper-img' /></div>").css({zIndex:3,position:"relative"}).append(i.find("span.fancytree-title").clone())).data("ftSourceNode",r),n):"<div>ERROR?: helper requested but sourceNode not found</div>"},start:function(e,t){return!!t.helper.data("ftSourceNode")}},t.options.dnd.draggable)),n&&n.dragDrop&&t.widget.element.droppable(e.extend({addClasses:!1,tolerance:"intersect",greedy:!1},t.options.dnd.droppable))}e.ui.fancytree.registerExtension({name:"dnd",version:"0.1.0",options:{autoExpandMS:1e3,draggable:null,droppable:null,focusOnClick:!1,preventVoidMoves:!0,preventRecursiveMoves:!0,dragStart:null,dragStop:null,dragEnter:null,dragOver:null,dragDrop:null,dragLeave:null},treeInit:function(t){var n=t.tree;this._super(t),n.options.dnd.dragStart&&n.$container.on("mousedown",(function(r){!n.hasFocus()&&t.options.dnd.focusOnClick&&(e.ui.fancytree.getNode(r).debug("Re-enable focus that was prevented by jQuery UI draggable."),setTimeout((function(){e(r.target).closest(":tabbable").focus()}),10))})),o(n)},nodeKeydown:function(t){return t.originalEvent.which===e.ui.keyCode.ESCAPE&&this._local._cancelDrag(),this._super(t)},nodeClick:function(e){return this._super(e)},_setDndStatus:function(t,n,r,i,o){var s,a,l=0,d="center",c=this._local,u=t?e(t.span):null,h=e(n.span);if(c.$dropMarker||(c.$dropMarker=e("<div id='fancytree-drop-marker'></div>").hide().css({"z-index":1e3}).prependTo(e(this.$div).parent())),"after"===i||"before"===i||"over"===i){switch(i){case"before":c.$dropMarker.removeClass("fancytree-drop-after fancytree-drop-over").addClass("fancytree-drop-before"),d="top";break;case"after":c.$dropMarker.removeClass("fancytree-drop-before fancytree-drop-over").addClass("fancytree-drop-after"),d="bottom";break;default:c.$dropMarker.removeClass("fancytree-drop-after fancytree-drop-before").addClass("fancytree-drop-over"),h.addClass("fancytree-drop-target"),l=8}s=e.ui.fancytree.jquerySupports.positionMyOfs?{my:"left"+(a=l,(0===a?"":a>0?"+"+a:""+a)+" center"),at:"left "+d,of:h}:{my:"left center",at:"left "+d,of:h,offset:l+" 0"},c.$dropMarker.show().position(s)}else h.removeClass("fancytree-drop-target"),c.$dropMarker.hide();"after"===i?h.addClass("fancytree-drop-after"):h.removeClass("fancytree-drop-after"),"before"===i?h.addClass("fancytree-drop-before"):h.removeClass("fancytree-drop-before"),!0===o?(u&&u.addClass("fancytree-drop-accept"),h.addClass("fancytree-drop-accept"),r.addClass("fancytree-drop-accept")):(u&&u.removeClass("fancytree-drop-accept"),h.removeClass("fancytree-drop-accept"),r.removeClass("fancytree-drop-accept")),!1===o?(u&&u.addClass("fancytree-drop-reject"),h.addClass("fancytree-drop-reject"),r.addClass("fancytree-drop-reject")):(u&&u.removeClass("fancytree-drop-reject"),h.removeClass("fancytree-drop-reject"),r.removeClass("fancytree-drop-reject"))},_onDragEvent:function(t,n,r,i,o,s){"over"!==t&&this.debug("tree.ext.dnd._onDragEvent(%s, %o, %o) - %o",t,n,r,this);var a,l,d,c,u,h,f=this.options.dnd,p=this._makeHookContext(n,i,{otherNode:r,ui:o,draggable:s}),y=null,g=e(n.span);switch(t){case"start":n.isStatusNode()?y=!1:f.dragStart&&(y=f.dragStart(n,p)),!1===y?(this.debug("tree.dragStart() cancelled"),o.helper.trigger("mouseup").hide()):g.addClass("fancytree-drag-source");break;case"enter":y=!!(h=(!f.preventRecursiveMoves||!n.isDescendantOf(r))&&(f.dragEnter?f.dragEnter(n,p):null))&&(e.isArray(h)?{over:e.inArray("over",h)>=0,before:e.inArray("before",h)>=0,after:e.inArray("after",h)>=0}:{over:!0===h||"over"===h,before:!0===h||"before"===h,after:!0===h||"after"===h}),o.helper.data("enterResponse",y),this.debug("helper.enterResponse: %o",y);break;case"over":u=null,!1===(c=o.helper.data("enterResponse"))||("string"==typeof c?u=c:(a=g.offset(),d={x:(l={x:i.pageX-a.left,y:i.pageY-a.top}).x/g.width(),y:l.y/g.height()},c.after&&d.y>.75||!c.over&&c.after&&d.y>.5?u="after":c.before&&d.y<=.25||!c.over&&c.before&&d.y<=.5?u="before":c.over&&(u="over"),f.preventVoidMoves&&(n===r?(this.debug("    drop over source node prevented"),u=null):"before"===u&&r&&n===r.getNextSibling()?(this.debug("    drop after source node prevented"),u=null):"after"===u&&r&&n===r.getPrevSibling()?(this.debug("    drop before source node prevented"),u=null):"over"===u&&r&&r.parent===n&&r.isLastSibling()&&(this.debug("    drop last child over own parent prevented"),u=null)),o.helper.data("hitMode",u))),"over"===u&&f.autoExpandMS&&!1!==n.hasChildren()&&!n.expanded&&n.scheduleAction("expand",f.autoExpandMS),u&&f.dragOver&&(p.hitMode=u,y=f.dragOver(n,p)),this._local._setDndStatus(r,n,o.helper,u,!1!==y&&null!==u);break;case"drop":(u=o.helper.data("hitMode"))&&f.dragDrop&&(p.hitMode=u,f.dragDrop(n,p));break;case"leave":n.scheduleAction("cancel"),o.helper.data("enterResponse",null),o.helper.data("hitMode",null),this._local._setDndStatus(r,n,o.helper,"out",void 0),f.dragLeave&&f.dragLeave(n,p);break;case"stop":g.removeClass("fancytree-drag-source"),f.dragStop&&f.dragStop(n,p);break;default:e.error("Unsupported drag event: "+t)}return y},_cancelDrag:function(){var t=e.ui.ddmanager.current;t&&t.cancel()}})}(jQuery,window,document),function(e,t,n,r){"use strict";var i=/Mac/.test(navigator.platform),o=e.ui.fancytree.escapeHtml,s=e.ui.fancytree.unescapeHtml;e.ui.fancytree._FancytreeNodeClass.prototype.editStart=function(){var t,r=this,i=this.tree,o=i.ext.edit,a=i.options.edit,l=e(".fancytree-title",r.span),d={node:r,tree:i,options:i.options,isNew:e(r.span).hasClass("fancytree-edit-new"),orgTitle:r.title,input:null,dirty:!1};if(!1===a.beforeEdit.call(r,{type:"beforeEdit"},d))return!1;e.ui.fancytree.assert(!o.currentNode,"recursive edit"),o.currentNode=this,o.eventData=d,i.widget._unbind(),e(n).on("mousedown.fancytree-edit",(function(t){e(t.target).hasClass("fancytree-edit-input")||r.editEnd(!0,t)})),t=e("<input />",{class:"fancytree-edit-input",type:"text",value:s(d.orgTitle)}),o.eventData.input=t,null!=a.adjustWidthOfs&&t.width(l.width()+a.adjustWidthOfs),null!=a.inputCss&&t.css(a.inputCss),l.html(t),t.focus().change((function(e){t.addClass("fancytree-edit-dirty")})).keydown((function(t){switch(t.which){case e.ui.keyCode.ESCAPE:r.editEnd(!1,t);break;case e.ui.keyCode.ENTER:return r.editEnd(!0,t),!1}t.stopPropagation()})).blur((function(e){return r.editEnd(!0,e)})),a.edit.call(r,{type:"edit"},d)},e.ui.fancytree._FancytreeNodeClass.prototype.editEnd=function(t,r){var i,s=this,a=this.tree,l=a.ext.edit,d=l.eventData,c=a.options.edit,u=e(".fancytree-title",s.span).find("input.fancytree-edit-input");return c.trim&&u.val(e.trim(u.val())),i=u.val(),d.dirty=i!==s.title,!1===t?d.save=!1:d.isNew?d.save=""!==i:d.save=d.dirty&&""!==i,!1!==c.beforeClose.call(s,{type:"beforeClose"},d)&&((!d.save||!1!==c.save.call(s,{type:"save"},d))&&(u.removeClass("fancytree-edit-dirty").unbind(),e(n).off(".fancytree-edit"),d.save?(s.setTitle(o(i)),s.setFocus()):d.isNew?(s.remove(),s=d.node=null,l.relatedNode.setFocus()):(s.renderTitle(),s.setFocus()),l.eventData=null,l.currentNode=null,l.relatedNode=null,a.widget._bind(),e(a.$container).focus(),d.input=null,c.close.call(s,{type:"close"},d),!0))},e.ui.fancytree._FancytreeNodeClass.prototype.editCreateNode=function(t,n){var r,i=this;t=t||"child",null==n?n={title:""}:"string"==typeof n?n={title:n}:e.ui.fancytree.assert(e.isPlainObject(n)),"child"!==t||this.isExpanded()||!1===this.hasChildren()?((r=this.addNode(n,t)).makeVisible(),e(r.span).addClass("fancytree-edit-new"),this.tree.ext.edit.relatedNode=this,r.editStart()):this.setExpanded().done((function(){i.editCreateNode(t,n)}))},e.ui.fancytree._FancytreeClass.prototype.isEditing=function(){return this.ext.edit.currentNode},e.ui.fancytree._FancytreeNodeClass.prototype.isEditing=function(){return this.tree.ext.edit.currentNode===this},e.ui.fancytree.registerExtension({name:"edit",version:"0.2.0",options:{adjustWidthOfs:4,allowEmpty:!1,inputCss:{minWidth:"3em"},triggerCancel:["esc","tab","click"],triggerStart:["f2","shift+click","mac+enter"],trim:!0,beforeClose:e.noop,beforeEdit:e.noop,close:e.noop,edit:e.noop,save:e.noop},currentNode:null,treeInit:function(e){this._super(e),this.$container.addClass("fancytree-ext-edit")},nodeClick:function(t){return e.inArray("shift+click",t.options.edit.triggerStart)>=0&&t.originalEvent.shiftKey?(t.node.editStart(),!1):this._super(t)},nodeDblclick:function(t){return e.inArray("dblclick",t.options.edit.triggerStart)>=0?(t.node.editStart(),!1):this._super(t)},nodeKeydown:function(t){switch(t.originalEvent.which){case 113:if(e.inArray("f2",t.options.edit.triggerStart)>=0)return t.node.editStart(),!1;break;case e.ui.keyCode.ENTER:if(e.inArray("mac+enter",t.options.edit.triggerStart)>=0&&i)return t.node.editStart(),!1}return this._super(t)}})}(jQuery,window,document),function(e,t,n,r){"use strict";function i(e){return(e+"").replace(/([.?*+\^\$\[\]\\(){}|-])/g,"\\$1")}e.ui.fancytree._FancytreeClass.prototype._applyFilterImpl=function(e,t,n){var r,o,s=0,a="hide"===this.options.filter.mode;return n=!!n&&!t,"string"==typeof e&&(r=i(e),o=new RegExp(".*"+r+".*","i"),e=function(e){return!!o.exec(e.title)}),this.enableFilter=!0,this.lastFilterArgs=arguments,this.$div.addClass("fancytree-ext-filter"),a?this.$div.addClass("fancytree-ext-filter-hide"):this.$div.addClass("fancytree-ext-filter-dimm"),this.visit((function(e){delete e.match,delete e.subMatch})),this.visit((function(r){if((!n||null==r.children)&&e(r)&&(s++,r.match=!0,r.visitParents((function(e){e.subMatch=!0})),t))return r.visit((function(e){e.match=!0})),"skip"})),this.render(),s},e.ui.fancytree._FancytreeClass.prototype.filterNodes=function(e,t){return this._applyFilterImpl(e,!1,t)},e.ui.fancytree._FancytreeClass.prototype.applyFilter=function(e){return this.warn("Fancytree.applyFilter() is deprecated since 2014-05-10. Use .filterNodes() instead."),this.filterNodes.apply(this,arguments)},e.ui.fancytree._FancytreeClass.prototype.filterBranches=function(e){return this._applyFilterImpl(e,!0,null)},e.ui.fancytree._FancytreeClass.prototype.clearFilter=function(){this.visit((function(e){delete e.match,delete e.subMatch})),this.enableFilter=!1,this.lastFilterArgs=null,this.$div.removeClass("fancytree-ext-filter fancytree-ext-filter-dimm fancytree-ext-filter-hide"),this.render()},e.ui.fancytree.registerExtension({name:"filter",version:"0.3.0",options:{autoApply:!0,mode:"dimm"},treeInit:function(e){this._super(e)},nodeLoadChildren:function(e,t){return this._super(e,t).done((function(){e.tree.enableFilter&&e.tree.lastFilterArgs&&e.options.filter.autoApply&&e.tree._applyFilterImpl.apply(e.tree,e.tree.lastFilterArgs)}))},nodeRenderStatus:function(t){var n,r=t.node,i=t.tree,o=e(r[i.statusClassPropName]);return n=this._super(t),o.length&&i.enableFilter?(o.toggleClass("fancytree-match",!!r.match).toggleClass("fancytree-submatch",!!r.subMatch).toggleClass("fancytree-hide",!(r.match||r.subMatch)),n):n}})}(jQuery,window,document),function(e,t,n,r){"use strict";function i(e,t){return e.map[t]}e.ui.fancytree.registerExtension({name:"glyph",version:"0.2.0",options:{map:{checkbox:"icon-check-empty",checkboxSelected:"icon-check",checkboxUnknown:"icon-check icon-muted",error:"icon-exclamation-sign",expanderClosed:"icon-caret-right",expanderLazy:"icon-angle-right",expanderOpen:"icon-caret-down",doc:"icon-file-alt",noExpander:"",docOpen:"icon-file-alt",loading:"icon-refresh icon-spin",folder:"icon-folder-close-alt",folderOpen:"icon-folder-open-alt"}},treeInit:function(e){var t=e.tree;this._super(e),t.$container.addClass("fancytree-ext-glyph")},nodeRenderStatus:function(t){var n,r,o=t.node,s=e(o.span),a=t.options.glyph,l=a.map;this._super(t),o.isRoot()||((r=s.children("span.fancytree-expander").get(0))&&(n=o.isLoading()?"loading":o.expanded?"expanderOpen":o.isUndefined()?"expanderLazy":o.hasChildren()?"expanderClosed":"noExpander",r.className="fancytree-expander "+l[n]),(r=o.tr?e("td",o.tr).children("span.fancytree-checkbox").get(0):s.children("span.fancytree-checkbox").get(0))&&(n=o.selected?"checkboxSelected":o.partsel?"checkboxUnknown":"checkbox",r.className="fancytree-checkbox "+l[n]),(r=s.children("span.fancytree-icon").get(0))&&(n=o.folder?o.expanded?i(a,"folderOpen"):i(a,"folder"):o.expanded?i(a,"docOpen"):i(a,"doc"),r.className="fancytree-icon "+n))},nodeSetStatus:function(t,n,r,o){var s,a=t.options.glyph,l=t.node;this._super(t,n,r,o),s=l.parent?e("span.fancytree-expander",l.span).get(0):e(".fancytree-statusnode-wait, .fancytree-statusnode-error",l[this.nodeContainerAttrName]).find("span.fancytree-expander").get(0),"loading"===n?s.className="fancytree-expander "+i(a,"loading"):"error"===n&&(s.className="fancytree-expander "+i(a,"error"))}})}(jQuery,window,document),function(e,t,n,r){"use strict";var i=e.ui.keyCode,o={text:[i.UP,i.DOWN],checkbox:[i.UP,i.DOWN,i.LEFT,i.RIGHT],radiobutton:[i.UP,i.DOWN,i.LEFT,i.RIGHT],"select-one":[i.LEFT,i.RIGHT],"select-multiple":[i.LEFT,i.RIGHT]};function s(t,n){var r,i=null,o=0;return t.children().each((function(){if(o>=n)return i=e(this),!1;r=e(this).prop("colspan"),o+=r||1})),i}function a(t,n){var r,o,a=t.closest("td"),l=null;switch(n){case i.LEFT:l=a.prev();break;case i.RIGHT:l=a.next();break;case i.UP:case i.DOWN:for(o=function(t,n){var r,i=n.get(0),o=0;return t.children().each((function(){if(this===i)return!1;r=e(this).prop("colspan"),o+=r||1})),o}(r=a.parent(),a);(r=n===i.UP?r.prev():r.next()).length&&(r.is(":hidden")||!(l=s(r,o))||!l.find(":input").length););}return l}e.ui.fancytree.registerExtension({name:"gridnav",version:"0.0.1",options:{autofocusInput:!1,handleCursorKeys:!0},treeInit:function(t){this._requireExtension("table",!0,!0),this._super(t),this.$container.addClass("fancytree-ext-gridnav"),this.$container.on("focusin",(function(n){var r,i=e.ui.fancytree.getNode(n.target);i&&!i.isActive()&&(r=t.tree._makeHookContext(i,n),t.tree._callHook("nodeSetActive",r,!0))}))},nodeSetActive:function(t,n){var r=t.options.gridnav,i=t.node,o=t.originalEvent||{},s=e(o.target).is(":input");n=!1!==n,this._super(t,n),n&&(t.options.titlesTabbable?(s||(e(i.span).find("span.fancytree-title").focus(),i.setFocus()),t.tree.$container.attr("tabindex","-1")):r.autofocusInput&&!s&&e(i.tr||i.span).find(":input:enabled:first").focus())},nodeKeydown:function(t){var n,r,i,s=t.options.gridnav,l=t.originalEvent,d=e(l.target);return(n=d.is(":input:enabled")?d.prop("type"):null)&&s.handleCursorKeys?!((r=o[n])&&e.inArray(l.which,r)>=0&&(i=a(d,l.which))&&i.length)||(i.find(":input:enabled").focus(),!1):(t.tree.debug("ext-gridnav NOT HANDLED",l,n),this._super(t))}})}(jQuery,window,document),function(e,t,n,r){"use strict";var i=e.ui.fancytree.assert;e.ui.fancytree._FancytreeClass.prototype.clearCookies=function(e){var t=this.ext.persist,n=t.cookiePrefix;(e=e||"active expanded focus selected").indexOf("active")>=0&&t._data(n+"active",null),e.indexOf("expanded")>=0&&t._data(n+"expanded",null),e.indexOf("focus")>=0&&t._data(n+"focus",null),e.indexOf("selected")>=0&&t._data(n+"selected",null)},e.ui.fancytree._FancytreeClass.prototype.getPersistData=function(){var e=this.ext.persist,t=e.cookiePrefix,n=e.cookieDelimiter,r={};return r.active=e._data(t+"active"),r.expanded=(e._data(t+"expanded")||"").split(n),r.selected=(e._data(t+"selected")||"").split(n),r.focus=e._data(t+"focus"),r},e.ui.fancytree.registerExtension({name:"persist",version:"0.3.0",options:{cookieDelimiter:"~",cookiePrefix:void 0,cookie:{raw:!1,expires:"",path:"",domain:"",secure:!1},expandLazy:!1,overrideSource:!0,store:"auto",types:"active expanded focus selected"},_data:function(t,n){var r=this._local.localStorage;if(void 0===n)return r?r.getItem(t):e.cookie(t);null===n?r?r.removeItem(t):e.removeCookie(t):r?r.setItem(t,n):e.cookie(t,n,this.options.persist.cookie)},_appendKey:function(t,n,r){n=""+n;var i=this._local,o=this.options.persist.cookieDelimiter,s=i.cookiePrefix+t,a=i._data(s),l=a?a.split(o):[],d=e.inArray(n,l);d>=0&&l.splice(d,1),r&&l.push(n),i._data(s,l.join(o))},treeInit:function(n){var r=n.tree,o=n.options,s=this._local,a=this.options.persist;return i("localStore"===a.store||e.cookie,"Missing required plugin for 'persist' extension: jquery.cookie.js"),s.cookiePrefix=a.cookiePrefix||"fancytree-"+r._id+"-",s.storeActive=a.types.indexOf("active")>=0,s.storeExpanded=a.types.indexOf("expanded")>=0,s.storeSelected=a.types.indexOf("selected")>=0,s.storeFocus=a.types.indexOf("focus")>=0,"cookie"!==a.store&&t.localStorage?s.localStorage="local"===a.store?t.localStorage:t.sessionStorage:s.localStorage=null,r.$div.bind("fancytreeinit",(function(t){var n,i,l,d,c=e.cookie(s.cookiePrefix+"focus");n=s._data(s.cookiePrefix+"expanded"),l=n&&n.split(a.cookieDelimiter),(s.storeExpanded?function t(n,r,i,o,s){var a,l,d,c,u=!1,h=[],f=[];for(i=i||[],s=s||e.Deferred(),a=0,d=i.length;a<d;a++)l=i[a],(c=n.getNodeByKey(l))?o&&c.isUndefined()?(u=!0,n.debug("_loadLazyNodes: "+c+" is lazy: loading..."),"expand"===o?h.push(c.setExpanded()):h.push(c.load())):(n.debug("_loadLazyNodes: "+c+" already loaded."),c.setExpanded()):(f.push(l),n.debug("_loadLazyNodes: "+c+" was not yet found."));return e.when.apply(e,h).always((function(){if(u&&f.length>0)t(n,r,f,o,s);else{if(f.length)for(n.warn("_loadLazyNodes: could not load those keys: ",f),a=0,d=f.length;a<d;a++)l=i[a],r._appendKey("expanded",i[a],!1);s.resolve()}})),s}(r,s,l,!!a.expandLazy&&"expand",null):(new e.Deferred).resolve()).done((function(){if(s.storeSelected){if(n=s._data(s.cookiePrefix+"selected"))for(l=n.split(a.cookieDelimiter),i=0;i<l.length;i++)(d=r.getNodeByKey(l[i]))?(void 0===d.selected||a.overrideSource&&!1===d.selected)&&(d.selected=!0,d.renderStatus()):s._appendKey("selected",l[i],!1);3===r.options.selectMode&&r.visit((function(e){if(e.selected)return e.fixSelection3AfterClick(),"skip"}))}s.storeActive&&(!(n=s._data(s.cookiePrefix+"active"))||!o.persist.overrideSource&&r.activeNode||(d=r.getNodeByKey(n))&&d.setActive()),s.storeFocus&&c&&(d=r.getNodeByKey(c))&&d.setFocus(),r._triggerTreeEvent("restore",null,{})}))})),this._super(n)},nodeSetActive:function(e,t,n){var r,i=this._local;return t=!1!==t,r=this._super(e,t,n),i.storeActive&&i._data(i.cookiePrefix+"active",this.activeNode?this.activeNode.key:null),r},nodeSetExpanded:function(e,t,n){var r,i=e.node,o=this._local;return t=!1!==t,r=this._super(e,t,n),o.storeExpanded&&o._appendKey("expanded",i.key,t),r},nodeSetFocus:function(e,t){var n,r=this._local;return t=!1!==t,n=this._super(e,t),t&&r.storeFocus&&r._data(r.cookiePrefix+"focus",this.focusNode?this.focusNode.key:null),n},nodeSetSelected:function(t,n){var r,i,o=t.tree,s=t.node,a=this._local;return n=!1!==n,r=this._super(t,n),a.storeSelected&&(3===o.options.selectMode?(i=(i=e.map(o.getSelectedNodes(!0),(function(e){return e.key}))).join(t.options.persist.cookieDelimiter),a._data(a.cookiePrefix+"selected",i)):a._appendKey("selected",s.key,n)),r}})}(jQuery,window,document),function(e,t,n,r){"use strict";function i(t,n){n=n||"",t||e.error("Assertion failed "+n)}function o(e,t){e.visit((function(e){var n=e.tr;if(n&&(n.style.display=e.hide||!t?"none":""),!e.expanded)return"skip"}))}e.ui.fancytree.registerExtension({name:"table",version:"0.2.0",options:{checkboxColumnIdx:null,customStatus:!1,indentation:16,nodeColumnIdx:0},treeInit:function(t){var r,i,o,s=t.tree,a=s.widget.element;for(a.addClass("fancytree-container fancytree-ext-table"),s.tbody=a.find("> tbody")[0],s.columnCount=e("thead >tr >th",a).length,e(s.tbody).empty(),s.rowFragment=n.createDocumentFragment(),i=e("<tr />"),o="",t.options.aria&&(i.attr("role","row"),o=" role='gridcell'"),r=0;r<s.columnCount;r++)t.options.table.nodeColumnIdx===r?i.append("<td"+o+"><span class='fancytree-node' /></td>"):i.append("<td"+o+" />");s.rowFragment.appendChild(i.get(0)),s.statusClassPropName="tr",s.ariaPropName="tr",this.nodeContainerAttrName="tr",this._super(t),e(s.rootNode.ul).remove(),s.rootNode.ul=null,s.$container=a,this.$container.attr("tabindex",this.options.tabbable?"0":"-1"),this.options.aria&&s.$container.attr("role","treegrid").attr("aria-readonly",!0)},nodeRemoveChildMarkup:function(t){t.node.visit((function(t){t.tr&&(e(t.tr).remove(),t.tr=null)}))},nodeRemoveMarkup:function(t){var n=t.node;n.tr&&(e(n.tr).remove(),n.tr=null),this.nodeRemoveChildMarkup(t)},nodeRender:function(t,n,r,s,a){var l,d,c,u,h,f,p,y,g,v,m=t.tree,x=t.node,b=t.options,_=!x.parent;if(a||(t.hasCollapsedParents=x.parent&&!x.parent.expanded),!_)if(x.tr)n?this.nodeRenderTitle(t):this.nodeRenderStatus(t);else{if(t.hasCollapsedParents)return void x.debug("nodeRender ignored due to unrendered parent");h=m.rowFragment.firstChild.cloneNode(!0),f=function(t){var n,r,o=t.parent,s=o?o.children:null;if(s&&s.length>1&&s[0]!==t)for(i((r=s[e.inArray(t,s)-1]).tr);r.children&&(n=r.children[r.children.length-1]).tr;)r=n;else r=o;return r}(x),i(f),(!0===s&&a||r&&t.hasCollapsedParents)&&(h.style.display="none"),f.tr?(g=f.tr,v=h,g.parentNode.insertBefore(v,g.nextSibling)):(i(!f.parent,"prev. row must have a tr, or is system root"),m.tbody.appendChild(h)),x.tr=h,x.key&&b.generateIds&&(x.tr.id=b.idPrefix+x.key),x.tr.ftnode=x,b.aria&&e(x.tr).attr("aria-labelledby","ftal_"+x.key),x.span=e("span.fancytree-node",x.tr).get(0),this.nodeRenderTitle(t),b.createNode&&b.createNode.call(m,{type:"createNode"},t)}if(b.renderNode&&b.renderNode.call(m,{type:"renderNode"},t),(l=x.children)&&(_||r||x.expanded))for(c=0,u=l.length;c<u;c++)(y=e.extend({},t,{node:l[c]})).hasCollapsedParents=y.hasCollapsedParents||!x.expanded,this.nodeRender(y,n,r,s,!0);l&&!a&&(p=x.tr||null,d=m.tbody.firstChild,x.visit((function(e){if(e.tr){if(e.parent.expanded||"none"===e.tr.style.display||(e.tr.style.display="none",o(e,!1)),e.tr.previousSibling!==p){x.debug("_fixOrder: mismatch at node: "+e);var t=p?p.nextSibling:d;m.tbody.insertBefore(e.tr,t)}p=e.tr}})))},nodeRenderTitle:function(t,n){var r,i=t.node,o=t.options;this._super(t),o.checkbox&&null!=o.table.checkboxColumnIdx&&(r=e("span.fancytree-checkbox",i.span).detach(),e(i.tr).find("td:first").html(r)),i.isRoot()||this.nodeRenderStatus(t),!o.table.customStatus&&i.isStatusNode()||o.renderColumns&&o.renderColumns.call(t.tree,{type:"renderColumns"},t)},nodeRenderStatus:function(t){var n,r=t.node,i=t.options;this._super(t),e(r.tr).removeClass("fancytree-node"),n=(r.getLevel()-1)*i.table.indentation,e(r.span).css({marginLeft:n+"px"})},nodeSetExpanded:function(t,n,r){var i=new e.Deferred,s=e.extend({},r,{noEvents:!0,noAnimation:!0});function a(e){n=!1!==n,o(t.node,n),e?n&&t.options.autoScroll&&!r.noAnimation&&t.node.hasChildren()?t.node.getLastChild().scrollIntoView(!0,{topNode:t.node}).always((function(){r.noEvents||t.tree._triggerNodeEvent(n?"expand":"collapse",t),i.resolveWith(t.node)})):(r.noEvents||t.tree._triggerNodeEvent(n?"expand":"collapse",t),i.resolveWith(t.node)):(r.noEvents||t.tree._triggerNodeEvent(n?"expand":"collapse",t),i.rejectWith(t.node))}return r=r||{},this._super(t,n,s).done((function(){a(!0)})).fail((function(){a(!1)})),i.promise()},nodeSetStatus:function(t,n,r,i){if("ok"===n){var o=t.node,s=o.children?o.children[0]:null;s&&s.isStatusNode()&&e(s.tr).remove()}this._super(t,n,r,i)},treeClear:function(e){return this.nodeRemoveChildMarkup(this._makeHookContext(this.rootNode)),this._super(e)}})}(jQuery,window,document),function(e,t,n,r){"use strict";e.ui.fancytree.registerExtension({name:"themeroller",version:"0.0.1",options:{activeClass:"ui-state-active",foccusClass:"ui-state-focus",hoverClass:"ui-state-hover",selectedClass:"ui-state-highlight"},treeInit:function(t){this._super(t);var n=t.widget.element;"TABLE"===n[0].nodeName?(n.addClass("ui-widget ui-corner-all"),n.find(">thead tr").addClass("ui-widget-header"),n.find(">tbody").addClass("ui-widget-conent")):n.addClass("ui-widget ui-widget-content ui-corner-all"),n.delegate(".fancytree-node","mouseenter mouseleave",(function(t){var n=e.ui.fancytree.getNode(t.target),r="mouseenter"===t.type;n.debug("hover: "+r),e(n.span).toggleClass("ui-state-hover ui-corner-all",r)}))},treeDestroy:function(e){this._super(e),e.widget.element.removeClass("ui-widget ui-widget-content ui-corner-all")},nodeRenderStatus:function(t){var n=t.node,r=e(n.span);this._super(t),r.toggleClass("ui-state-active",n.isActive()),r.toggleClass("ui-state-focus",n.hasFocus()),r.toggleClass("ui-state-highlight",n.isSelected())}})}(jQuery,window,document),function(e,t,n,r){"use strict";var i=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function o(t,n){var r=e("#"+(t="fancytree-style-"+t));if(!n)return r.remove(),null;r.length||(r=e("<style />").attr("id",t).addClass("fancytree-style").prop("type","text/css").appendTo("head"));try{r.html(n)}catch(e){r[0].styleSheet.cssText=n}return r}function s(e,t,n,r,i){var o,s="#"+e+" span.fancytree-level-",a=[];for(o=0;o<t;o++)a.push(s+(o+1)+" span.fancytree-title { padding-left: "+(o*n+r)+i+"; }");return a.push("#"+e+" div.ui-effects-wrapper ul li span.fancytree-title { padding-left: 3px; position: static; width: auto; }"),a.join("\n")}e.ui.fancytree.registerExtension({name:"wide",version:"0.0.3",options:{iconWidth:null,iconSpacing:null,levelOfs:null},treeCreate:function(t){this._super(t),this.$container.addClass("fancytree-ext-wide");var n,r,a,l,d=t.options.wide,c=e("<li id='fancytreeTemp'><span class='fancytree-node'><span class='fancytree-icon' /><span class='fancytree-title' /></span><ul />").appendTo(t.tree.$container),u=c.find(".fancytree-icon"),h=c.find("ul"),f=d.iconSpacing||u.css("margin-left"),p=d.iconWidth||u.css("width"),y=d.levelOfs||h.css("padding-left");c.remove(),r=f.match(i)[2],f=parseFloat(f,10),a=p.match(i)[2],p=parseFloat(p,10),l=y.match(i)[2],r===a&&l===a||e.error("iconWidth, iconSpacing, and levelOfs must have the same css measure unit"),this._local.measureUnit=a,this._local.levelOfs=parseFloat(y),this._local.lineOfs=(t.options.checkbox?3:2)*(p+f)+f,this._local.maxDepth=10,o(n=this.$container.uniqueId().attr("id"),s(n,this._local.maxDepth,this._local.levelOfs,this._local.lineOfs,this._local.measureUnit))},treeDestroy:function(e){return o(this.$container.attr("id"),null),this._super(e)},nodeRenderStatus:function(t){var n,r,i=t.node,a=i.getLevel();return r=this._super(t),a>this._local.maxDepth&&(n=this.$container.attr("id"),this._local.maxDepth*=2,i.debug("Define global ext-wide css up to level "+this._local.maxDepth),o(n,s(n,this._local.maxDepth,this._local.levelOfs,this._local.lineOfs,this._local.measureUnit))),e(i.span).addClass("fancytree-level-"+a),r}})}(jQuery,window,document),function(e,t,n,r){"use strict";var i=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function o(t,n){var r=e("#"+(t="fancytree-style-"+t));if(!n)return r.remove(),null;r.length||(r=e("<style />").attr("id",t).addClass("fancytree-style").prop("type","text/css").appendTo("head"));try{r.html(n)}catch(e){r[0].styleSheet.cssText=n}return r}function s(e,t,n,r,i){var o,s="#"+e+" span.fancytree-level-",a=[];for(o=0;o<t;o++)a.push(s+(o+1)+" span.fancytree-title { padding-left: "+(o*n+r)+i+"; }");return a.push("#"+e+" div.ui-effects-wrapper ul li span.fancytree-title { padding-left: 3px; position: static; width: auto; }"),a.join("\n")}e.ui.fancytree.registerExtension({name:"wide",version:"0.0.3",options:{iconWidth:null,iconSpacing:null,levelOfs:null},treeCreate:function(t){this._super(t),this.$container.addClass("fancytree-ext-wide");var n,r,a,l,d=t.options.wide,c=e("<li id='fancytreeTemp'><span class='fancytree-node'><span class='fancytree-icon' /><span class='fancytree-title' /></span><ul />").appendTo(t.tree.$container),u=c.find(".fancytree-icon"),h=c.find("ul"),f=d.iconSpacing||u.css("margin-left"),p=d.iconWidth||u.css("width"),y=d.levelOfs||h.css("padding-left");c.remove(),r=f.match(i)[2],f=parseFloat(f,10),a=p.match(i)[2],p=parseFloat(p,10),l=y.match(i)[2],r===a&&l===a||e.error("iconWidth, iconSpacing, and levelOfs must have the same css measure unit"),this._local.measureUnit=a,this._local.levelOfs=parseFloat(y),this._local.lineOfs=(t.options.checkbox?3:2)*(p+f)+f,this._local.maxDepth=10,o(n=this.$container.uniqueId().attr("id"),s(n,this._local.maxDepth,this._local.levelOfs,this._local.lineOfs,this._local.measureUnit))},treeDestroy:function(e){return o(this.$container.attr("id"),null),this._super(e)},nodeRenderStatus:function(t){var n,r,i=t.node,a=i.getLevel();return r=this._super(t),a>this._local.maxDepth&&(n=this.$container.attr("id"),this._local.maxDepth*=2,i.debug("Define global ext-wide css up to level "+this._local.maxDepth),o(n,s(n,this._local.maxDepth,this._local.levelOfs,this._local.lineOfs,this._local.measureUnit))),e(i.span).addClass("fancytree-level-"+a),r}})}(jQuery,window,document),
/**!
 * jquery.fancytree.contextmenu.js
 * 3rd party jQuery Context menu extension for jQuery Fancytree
 *
 * Authors: Rodney Rehm, Addy Osmani (patches for FF)
 * Web: http://medialize.github.com/jQuery-contextMenu/
 *
 * Copyright (c) 2012, Martin Wendt (http://wwWendt.de)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://code.google.com/p/fancytree/wiki/LicenseInfe
 */
function(e,t){"use strict";e.ui.fancytree.registerExtension({name:"contextMenu",version:"1.0",contextMenu:{selector:"fancytree-title",menu:{},actions:{}},treeInit:function(t){var n,r,i,o;this._super(t),n=t.tree,r=t.options.contextMenu.selector||"fancytree-title",i=t.options.contextMenu.menu,o=t.options.contextMenu.actions,n.$container.on("mousedown.contextMenu",(function(t){var n=e.ui.fancytree.getNode(t);n&&(e.contextMenu("destroy","."+r),n.setFocus(!0),e.contextMenu({selector:"."+r,events:{hide:function(t){e.contextMenu("destroy","."+r)}},build:function(t,r){n=e.ui.fancytree.getNode(t);var s={};return e.isFunction(i)?s=i(n):e.isPlainObject(i)&&(s=i),{callback:function(t,r){e.isFunction(o)?o(n,t,r):e.isPlainObject(o)&&o.hasOwnProperty(t)&&e.isFunction(o[t])&&o[t](n,r)},items:s}}}))}))}})}(jQuery,document),$.ui.fancytree.registerExtension({name:"xsjcolor",version:"1.0.0",nodeRenderTitle:function(e,t){var n=e.node,r=n.data.color;this._super(e,t),null!=r&&("default"===r&&(r="var(--positiveColor)"),$("span.fancytree-title",n.span).css("color",r))}}),$.ui.fancytree.registerExtension({name:"xsjcounter",version:"1.0.0",nodeRenderTitle:function(e,t){var n=e.node,r=n.data.count;this._super(e,t),null!=r&&$("span.fancytree-title",n.span).append($("<small class='fancytree-xsjcounter'/>").text("("+r+")"))}}),$.ui.fancytree.registerExtension({name:"xsjgotobtn",version:"1.0.0",nodeRenderTitle:function(e,t){var n=e.node,r=n.data.goto;"function"==typeof r&&(r=r(n,n.data));var i=!1;null!=r&&!1!==r&&(i=!0),this._super(e,t);var o=$("span.fancytree-title",n.span);n.folder&&(i&&o.append($("<i class='arrow alternate circle right icon xsj_goto_button' title='\u4ec5\u663e\u793a\u5f53\u524d\u8282\u70b9\u4e0b\u7684\u6587\u7ae0'></i>")),o.append($("<i class='angle double right icon xsj_goto_more_button' title='\u663e\u793a\u5f53\u524d\u8282\u70b9\u53ca\u5b50\u8282\u70b9\u4e0b\u7684\u6240\u6709\u6587\u7ae0'></i>")))}}),$.ui.fancytree.registerExtension({name:"xsjtagbtn",version:"1.0.0",nodeRenderTitle:function(e,t){var n,r;if(r=(n=e.node).data.obj,this._super(e,t),r&&r.guid&&"-1"!==r.guid)return $("span.fancytree-title",n.span).append($("<i class='arrow alternate circle right icon xsj_tag_button' data-guid='"+_.escape(r.guid)+"'></i>"))}});
